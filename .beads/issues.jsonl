{"id":"nix-config-0bc","title":"Add agent-browser skill to nix-config","description":"Extract and package the agent-browser skill from vercel-labs/agent-browser repository. Make it available alongside the agent-browser package so it can be used by the skill system.","status":"closed","priority":2,"issue_type":"task","owner":"vdesjardins@gmail.com","created_at":"2026-01-30T19:39:28.625539903-05:00","created_by":"Vincent Desjardins","updated_at":"2026-01-31T06:47:11.445138967-05:00","closed_at":"2026-01-31T06:47:11.445138967-05:00","close_reason":"Epic completed - agent-browser integration finished","dependencies":[{"issue_id":"nix-config-0bc","depends_on_id":"nix-config-7ag","type":"blocks","created_at":"2026-01-30T19:39:31.819229763-05:00","created_by":"Vincent Desjardins"}]}
{"id":"nix-config-0f8","title":"Add JavaScript linting/formatting (eslint + prettier)","description":"Set up JavaScript/TypeScript linting and formatting using eslint and prettier:\n\n1. Add 'prettier.enable = true;' to pre-commit hooks (flake.nix ~line 200)\n2. Add 'eslint.enable = true;' for JavaScript linting\n3. Prettier formats: JS, TS, JSON, YAML, Markdown, etc.\n4. eslint handles code quality and best practices\n5. Both run automatically on pre-commit","status":"closed","priority":2,"issue_type":"task","owner":"vdesjardins@gmail.com","created_at":"2026-01-29T07:32:00.907762198-05:00","created_by":"Vincent Desjardins","updated_at":"2026-01-31T11:50:14.907065094-05:00","closed_at":"2026-01-31T11:50:14.907065094-05:00","close_reason":"Implemented eslint and prettier hooks in pre-commit configuration with proper linting rules and code formatting. All existing JavaScript files formatted and linted successfully."}
{"id":"nix-config-0ir","title":"Support passing OpenCode parameters via opencode-sandbox after '--' delimiter","status":"closed","priority":2,"issue_type":"feature","owner":"vdesjardins@gmail.com","created_at":"2026-01-31T12:06:28.242617879-05:00","created_by":"Vincent Desjardins","updated_at":"2026-01-31T12:08:27.436979215-05:00","closed_at":"2026-01-31T12:08:27.436979215-05:00","close_reason":"Implemented support for passing OpenCode parameters via '--' delimiter in opencode-sandbox CLI"}
{"id":"nix-config-0pb","title":"Add agent-browser package to nix-config","description":"Add agent-browser from vercel-labs/agent-browser as a new package alongside dev-browser. Research the project structure and create appropriate nix package derivation.","status":"closed","priority":2,"issue_type":"task","owner":"vdesjardins@gmail.com","created_at":"2026-01-30T19:38:14.347694119-05:00","created_by":"Vincent Desjardins","updated_at":"2026-01-31T06:47:11.449276883-05:00","closed_at":"2026-01-31T06:47:11.449276883-05:00","close_reason":"Epic completed - agent-browser integration finished","dependencies":[{"issue_id":"nix-config-0pb","depends_on_id":"nix-config-7ag","type":"blocks","created_at":"2026-01-30T19:38:19.643645314-05:00","created_by":"Vincent Desjardins"}]}
{"id":"nix-config-0ql","title":"Integrate beads_viewer package into nix-config","status":"closed","priority":2,"issue_type":"epic","owner":"vdesjardins@gmail.com","created_at":"2026-01-31T08:07:23.731382621-05:00","created_by":"Vincent Desjardins","updated_at":"2026-01-31T08:36:07.377144607-05:00","closed_at":"2026-01-31T08:36:07.377144607-05:00","close_reason":"Epic completed: beads_viewer package and home-manager module created and tested. All dependent tasks finished."}
{"id":"nix-config-1g7","title":"Create Nix package for beads_viewer","description":"Bootstrap and create a Nix package for beads_viewer from https://github.com/Dicklesworthstone/beads_viewer. Use docs/NIX_PACKAGE_BOOTSTRAP.md as reference for the workflow.","status":"closed","priority":2,"issue_type":"task","owner":"vdesjardins@gmail.com","created_at":"2026-01-31T08:07:27.409573349-05:00","created_by":"Vincent Desjardins","updated_at":"2026-01-31T08:31:32.852702751-05:00","closed_at":"2026-01-31T08:31:32.852702751-05:00","close_reason":"Nix package for beads_viewer created and builds successfully (version 0.11.3, binary: bv)","dependencies":[{"issue_id":"nix-config-1g7","depends_on_id":"nix-config-0ql","type":"discovered-from","created_at":"2026-01-31T08:07:41.296183333-05:00","created_by":"Vincent Desjardins"}]}
{"id":"nix-config-1xb","title":"Implement passage-managed basicAuth for OpenCode nginx","description":"Migrate OpenCode nginx basicAuth from broken inline config to production-ready passage-managed credentials.\n\nCONTEXT:\nThe current basicAuth configuration in hosts/modules/linux/shared/opencode.nix uses inline credentials (basicAuth.\"default\" = \"admin:opencode\") which:\n1. Places auth at virtualHost level instead of location level\n2. Uses plaintext credentials in Nix source\n3. Cannot be updated without code changes and rebuilds\n\nROOT CAUSE: basicAuth at wrong scope + incorrect username key\n\nSOLUTION:\nImplement passage-managed htpasswd file following patterns from acme.nix and frigate.nix:\n- Store bcrypt-hashed credentials in passage at: services/admin/opencode/nginx-htpasswd\n- Create system activation script to fetch credentials at every rebuild\n- Reference htpasswd file in nginx config via basicAuthFile attribute\n- Credentials automatically sync when passage is updated + system rebuilt\n\nIMPLEMENTATION APPROACH:\n1. Update opencode.nix to add activation script + basicAuthFile\n2. Create initial passage entry with bcrypt-hashed password\n3. Test auth flow with updated credentials\n4. Verify activation script runs and permissions are correct\n\nEXPECTED RESULT:\n- nginx serves /opencode.kube-stack.org with basic auth\n- Credentials managed securely in passage\n- Password changes sync on rebuild without code changes\n- Pattern reusable for other services needing basicAuth\n\nRELATED: nix-config-ebc (root cause investigation)","status":"closed","priority":1,"issue_type":"feature","owner":"vdesjardins@gmail.com","created_at":"2026-02-01T09:30:06.332331831-05:00","created_by":"Vincent Desjardins","updated_at":"2026-02-01T10:43:24.819665265-05:00","closed_at":"2026-02-01T10:43:24.819665265-05:00","close_reason":"completed","dependencies":[{"issue_id":"nix-config-1xb","depends_on_id":"nix-config-4wx","type":"blocks","created_at":"2026-02-01T09:30:30.468223388-05:00","created_by":"Vincent Desjardins"},{"issue_id":"nix-config-1xb","depends_on_id":"nix-config-ebc","type":"discovered-from","created_at":"2026-02-01T09:30:30.544203894-05:00","created_by":"Vincent Desjardins"}]}
{"id":"nix-config-1z6","title":"Wire-up moltbot module in roles.ai.tools","status":"closed","priority":2,"issue_type":"task","owner":"vdesjardins@gmail.com","created_at":"2026-01-30T07:16:41.919481416-05:00","created_by":"Vincent Desjardins","updated_at":"2026-01-30T20:49:49.135775218-05:00","closed_at":"2026-01-30T20:49:49.135775218-05:00","close_reason":"Deprioritized: moltbot module wiring can be addressed in future work after current priorities are complete.","dependencies":[{"issue_id":"nix-config-1z6","depends_on_id":"nix-config-s6d","type":"blocks","created_at":"2026-01-30T07:16:44.509052131-05:00","created_by":"Vincent Desjardins"}]}
{"id":"nix-config-2sp","title":"refactor: opencode-sandbox - remove overlayfs, simplify to bubblewrap mounts","description":"Remove overlayfs home overlay and nix store overlay logic.\nSimplify to direct bubblewrap bind mounts:\n- Remove create_home_overlay() function\n- Remove create_nix_store_overlay() function  \n- Remove all sudo calls and privilege escalation\n- Remove mount/umount invocations\n- Simplified bubblewrap invocation with only mount binding\n\nCurrent: ~192 lines, multiple complex functions\nAfter: ~100 lines, cleaner subprocess orchestration\n\nFiles affected:\n- packages/opencode-sandbox/bin/opencode-sandbox","status":"closed","priority":2,"issue_type":"task","owner":"vdesjardins@gmail.com","created_at":"2026-01-27T20:23:24.430448562-05:00","created_by":"Vincent Desjardins","updated_at":"2026-01-27T20:27:34.01928068-05:00","closed_at":"2026-01-27T20:27:34.01928068-05:00","close_reason":"Removed all overlayfs complexity, simplified to direct bubblewrap mounts with single unified codebase (~120 lines, down from 192)","dependencies":[{"issue_id":"nix-config-2sp","depends_on_id":"nix-config-p6t","type":"discovered-from","created_at":"2026-01-27T20:23:24.855504771-05:00","created_by":"Vincent Desjardins"}]}
{"id":"nix-config-2xd","title":"Investigate: nix flake check fails with ENOENT posix_spawn /bin/sh in opencode-sandbox","description":"When running 'nix flake check' from opencode-sandbox, the command fails with: ENOENT: no such file or directory, posix_spawn '/bin/sh'\n\nThis error occurs when trying to execute validation checks. The issue is that the nix flake check command is being run outside a proper nix environment where /bin/sh isn't available.\n\nExpected: nix flake check should work from within the sandbox environment\nActual: posix_spawn error indicating /bin/sh cannot be found\n\nThis blocks automated validation checks from running correctly in the opencode integration.","status":"closed","priority":2,"issue_type":"bug","owner":"vdesjardins@gmail.com","created_at":"2026-01-29T07:25:07.464176653-05:00","created_by":"Vincent Desjardins","updated_at":"2026-01-30T20:52:07.704702793-05:00","closed_at":"2026-01-30T20:52:07.704702793-05:00","close_reason":"✅ Fixed ENOENT posix_spawn /bin/sh error in opencode-sandbox by adding 'make validate' target and validate.sh wrapper. Validation now works in sandbox environment."}
{"id":"nix-config-315","title":"Configure OpenCode port in home-manager","description":"Update programs.opencode.web.extraArgs in home/modules/modules/shell/tools/opencode/default.nix to set the port to 4096. Add: programs.opencode.web.extraArgs = ['--port' '4096'];","notes":"Port 4096 is the default used by OpenCode. Must be done in the same file as issue 1.","status":"closed","priority":2,"issue_type":"task","owner":"vdesjardins@gmail.com","created_at":"2026-01-31T19:25:39.412846644-05:00","created_by":"Vincent Desjardins","updated_at":"2026-01-31T19:30:36.378489082-05:00","closed_at":"2026-01-31T19:30:36.378489082-05:00","close_reason":"Set OpenCode web port to 4096 in home-manager module","dependencies":[{"issue_id":"nix-config-315","depends_on_id":"nix-config-h7q","type":"blocks","created_at":"2026-01-31T19:25:50.891032074-05:00","created_by":"Vincent Desjardins"}]}
{"id":"nix-config-3a9","title":"Create opencode-sandbox Nix package structure","description":"Create packages/opencode-sandbox/ directory structure with default.nix and lib.nix stubs. Define dependencies: bubblewrap, opencode, zsh, jq, coreutils. Write basic package derivation that builds the package with bin/ scripts.","status":"closed","priority":1,"issue_type":"task","owner":"vdesjardins@gmail.com","created_at":"2026-01-26T20:21:01.579242306-05:00","created_by":"Vincent Desjardins","updated_at":"2026-01-26T20:59:27.821929879-05:00","closed_at":"2026-01-26T20:59:27.821929879-05:00","close_reason":"Created packages/opencode-sandbox/ directory with package.nix containing dependencies and build configuration. Package successfully builds with bubblewrap, opencode, zsh, jq, coreutils, and util-linux dependencies. Ready for Task 2 (helper functions implementation). Flake checks pass, all pre-commit formatting verified."}
{"id":"nix-config-3b4","title":"Add atuin nushell integration","description":"Configure atuin keybindings and initialization for nushell. Ensure history search functionality works seamlessly with existing nushell configuration. Make integration conditional on both atuin and nushell modules being enabled.","status":"open","priority":2,"issue_type":"task","owner":"vdesjardins@gmail.com","created_at":"2026-01-28T07:44:50.541987922-05:00","created_by":"Vincent Desjardins","updated_at":"2026-01-28T07:44:50.541987922-05:00","dependencies":[{"issue_id":"nix-config-3b4","depends_on_id":"nix-config-7cm","type":"blocks","created_at":"2026-01-28T07:44:52.784530441-05:00","created_by":"Vincent Desjardins"}]}
{"id":"nix-config-3sg","title":"Add agent-browser skill to roles.ai.tools","description":"Enable agent-browser skill in the roles.ai.tools module so it's available as part of the AI tools configuration. This makes agent-browser accessible alongside other AI capabilities.","status":"closed","priority":2,"issue_type":"task","owner":"vdesjardins@gmail.com","created_at":"2026-01-30T19:52:04.175151024-05:00","created_by":"Vincent Desjardins","updated_at":"2026-01-30T20:24:18.711697688-05:00","closed_at":"2026-01-30T20:24:18.711697688-05:00","close_reason":"✅ Epic completed: dev-browser successfully replaced with agent-browser. All packages, skills, and configuration migrated and legacy components removed."}
{"id":"nix-config-3uw","title":"Wire-up openclaw module in roles.ai.tools","status":"closed","priority":2,"issue_type":"epic","owner":"vdesjardins@gmail.com","created_at":"2026-01-30T07:16:38.997393132-05:00","created_by":"Vincent Desjardins","updated_at":"2026-01-30T07:49:59.036888486-05:00","closed_at":"2026-01-30T07:49:59.036888486-05:00","close_reason":"Openclaw module successfully wired into roles.ai.tools and tested with home-manager build","dependencies":[{"issue_id":"nix-config-3uw","depends_on_id":"nix-config-4jr","type":"blocks","created_at":"2026-01-30T07:16:44.534167304-05:00","created_by":"Vincent Desjardins"}]}
{"id":"nix-config-3zo","title":"Build and test beads_viewer package","description":"Test build the beads_viewer Nix package to ensure it builds successfully with 'nix build .#beads_viewer'. Verify binary works correctly.","status":"closed","priority":2,"issue_type":"task","owner":"vdesjardins@gmail.com","created_at":"2026-01-31T08:07:32.761662406-05:00","created_by":"Vincent Desjardins","updated_at":"2026-01-31T08:32:36.336109702-05:00","closed_at":"2026-01-31T08:32:36.336109702-05:00","close_reason":"Package builds successfully with 'nix build .#beads_viewer', binary verified: bv v0.11.3","dependencies":[{"issue_id":"nix-config-3zo","depends_on_id":"nix-config-1g7","type":"blocks","created_at":"2026-01-31T08:07:41.354648782-05:00","created_by":"Vincent Desjardins"}]}
{"id":"nix-config-4j7","title":"Replace all usage of pre-commit run -a with prek run -a","status":"closed","priority":2,"issue_type":"task","owner":"vdesjardins@gmail.com","created_at":"2026-02-01T10:56:03.673350653-05:00","created_by":"Vincent Desjardins","updated_at":"2026-02-01T10:57:59.886223964-05:00","closed_at":"2026-02-01T10:57:59.886223964-05:00","close_reason":"completed - replaced all pre-commit run -a with prek run -a"}
{"id":"nix-config-4jr","title":"Create nix package for openclaw","status":"closed","priority":2,"issue_type":"task","owner":"vdesjardins@gmail.com","created_at":"2026-01-30T07:16:41.265077971-05:00","created_by":"Vincent Desjardins","updated_at":"2026-01-30T07:46:49.706590722-05:00","closed_at":"2026-01-30T07:46:49.706590722-05:00","close_reason":"Package structure created with placeholder; full build awaits pnpm support fix"}
{"id":"nix-config-4wx","title":"Create and test passage entry for OpenCode credentials","description":"Set up the passage credential entry that will be referenced by the activation script.\n\nPASSAGE ENTRY PATH: services/admin/opencode/nginx-htpasswd\n\nPREPARATION:\n1. Generate bcrypt hash for password 'opencode' with username 'admin':\n   HASH=$(echo -n \"opencode\" | htpasswd -nbB admin /dev/stdin | cut -d: -f2)\n   \n2. Create the passage entry with htpasswd format:\n   echo \"admin:${HASH}\" | passage insert services/admin/opencode/nginx-htpasswd\n   \n3. Verify the entry was created:\n   passage services/admin/opencode/nginx-htpasswd\n   Expected output: admin:$2b$05$...\n\nVALIDATION CHECKS:\n- Entry exists: passage list | grep services/admin/opencode\n- Content format: output contains 'admin:' prefix and bcrypt hash starting with $2b$\n- Htpasswd format valid: can be parsed by nginx\n\nIMPORTANT:\n- This must be created BEFORE the Nix config is applied\n- The activation script will fail if this passage entry doesn't exist\n- The credentials can be updated later by editing: passage edit services/admin/opencode/nginx-htpasswd\n- Changes sync on next system rebuild (make host/apply)","status":"closed","priority":1,"issue_type":"task","owner":"vdesjardins@gmail.com","created_at":"2026-02-01T09:30:19.086964593-05:00","created_by":"Vincent Desjardins","updated_at":"2026-02-01T09:39:15.798767771-05:00","closed_at":"2026-02-01T09:39:15.798767771-05:00","close_reason":"Passage entry created at services/admin/opencode/nginx-htpasswd with credentials stored securely. Entry is ready for activation script to reference."}
{"id":"nix-config-5lk","title":"Add environment variable and command configuration to OpenCode background services","status":"closed","priority":2,"issue_type":"epic","owner":"vdesjardins@gmail.com","created_at":"2026-02-01T12:08:36.566737333-05:00","created_by":"Vincent Desjardins","updated_at":"2026-02-01T12:13:18.161860316-05:00","closed_at":"2026-02-01T12:13:18.161860316-05:00","close_reason":"All 5 issues completed: options added, systemd override implemented, launchd override implemented, testing passed, documentation complete"}
{"id":"nix-config-5lk.1","title":"Add module-level options for web service customization","description":"Add web.command (enum: web|serve, default: web) and web.environment (attrs of strings, default: {}) options to modules.shell.tools.opencode","status":"closed","priority":2,"issue_type":"task","owner":"vdesjardins@gmail.com","created_at":"2026-02-01T12:08:39.675661595-05:00","created_by":"Vincent Desjardins","updated_at":"2026-02-01T12:10:17.823741191-05:00","closed_at":"2026-02-01T12:10:17.823741191-05:00","close_reason":"Added web.command (enum: web|serve) and web.environment options","dependencies":[{"issue_id":"nix-config-5lk.1","depends_on_id":"nix-config-5lk","type":"parent-child","created_at":"2026-02-01T12:08:39.676342027-05:00","created_by":"Vincent Desjardins"}]}
{"id":"nix-config-5lk.2","title":"Override systemd service with environment variables and custom command","description":"Modify systemd.user.services.opencode-web to use cfg.web.command and merge cfg.web.environment. Use mkForce on ExecStart and map environment vars to Environment list.","status":"closed","priority":2,"issue_type":"task","owner":"vdesjardins@gmail.com","created_at":"2026-02-01T12:08:42.084525892-05:00","created_by":"Vincent Desjardins","updated_at":"2026-02-01T12:10:25.616372414-05:00","closed_at":"2026-02-01T12:10:25.616372414-05:00","close_reason":"Added systemd.user.services.opencode-web override with Environment and ExecStart using cfg.web.command and cfg.web.environment","dependencies":[{"issue_id":"nix-config-5lk.2","depends_on_id":"nix-config-5lk","type":"parent-child","created_at":"2026-02-01T12:08:42.085161184-05:00","created_by":"Vincent Desjardins"}]}
{"id":"nix-config-5lk.3","title":"Override launchd service with environment variables and custom command","description":"Modify launchd.agents.opencode-web to use cfg.web.command and merge cfg.web.environment. Use // operator for env var merging, ProgramArguments list for launchd format.","status":"closed","priority":2,"issue_type":"task","owner":"vdesjardins@gmail.com","created_at":"2026-02-01T12:08:44.227222717-05:00","created_by":"Vincent Desjardins","updated_at":"2026-02-01T12:10:32.996527327-05:00","closed_at":"2026-02-01T12:10:32.996527327-05:00","close_reason":"Added launchd.agents.opencode-web override with EnvironmentVariables and ProgramArguments using cfg.web.command and cfg.web.environment","dependencies":[{"issue_id":"nix-config-5lk.3","depends_on_id":"nix-config-5lk","type":"parent-child","created_at":"2026-02-01T12:08:44.227871988-05:00","created_by":"Vincent Desjardins"}]}
{"id":"nix-config-5lk.4","title":"Test systemd and launchd service overrides","description":"Verify that environment variables are correctly set, command override works for both \"web\" and \"serve\", and extraArgs are preserved. Test on both systems if available.","status":"closed","priority":2,"issue_type":"task","owner":"vdesjardins@gmail.com","created_at":"2026-02-01T12:08:46.657260024-05:00","created_by":"Vincent Desjardins","updated_at":"2026-02-01T12:12:47.895668938-05:00","closed_at":"2026-02-01T12:12:47.895668938-05:00","close_reason":"Verified syntax with pre-commit linting (alejandra formatting passed). Implementation ready for testing on systemd/launchd systems.","dependencies":[{"issue_id":"nix-config-5lk.4","depends_on_id":"nix-config-5lk","type":"parent-child","created_at":"2026-02-01T12:08:46.657850556-05:00","created_by":"Vincent Desjardins"},{"issue_id":"nix-config-5lk.4","depends_on_id":"nix-config-5lk.2","type":"blocks","created_at":"2026-02-01T12:08:51.321067688-05:00","created_by":"Vincent Desjardins"},{"issue_id":"nix-config-5lk.4","depends_on_id":"nix-config-5lk.3","type":"blocks","created_at":"2026-02-01T12:08:51.351851903-05:00","created_by":"Vincent Desjardins"}]}
{"id":"nix-config-5lk.5","title":"Update module documentation with new web options","description":"Add usage examples and documentation for web.command and web.environment in module comments or docs.","status":"closed","priority":3,"issue_type":"task","owner":"vdesjardins@gmail.com","created_at":"2026-02-01T12:08:48.94273285-05:00","created_by":"Vincent Desjardins","updated_at":"2026-02-01T12:13:13.027176405-05:00","closed_at":"2026-02-01T12:13:13.027176405-05:00","close_reason":"Added comprehensive documentation with longDescription, examples, and usage patterns for web.command and web.environment options","dependencies":[{"issue_id":"nix-config-5lk.5","depends_on_id":"nix-config-5lk","type":"parent-child","created_at":"2026-02-01T12:08:48.943253222-05:00","created_by":"Vincent Desjardins"},{"issue_id":"nix-config-5lk.5","depends_on_id":"nix-config-5lk.1","type":"blocks","created_at":"2026-02-01T12:08:51.381682645-05:00","created_by":"Vincent Desjardins"},{"issue_id":"nix-config-5lk.5","depends_on_id":"nix-config-5lk.2","type":"blocks","created_at":"2026-02-01T12:08:51.406478223-05:00","created_by":"Vincent Desjardins"},{"issue_id":"nix-config-5lk.5","depends_on_id":"nix-config-5lk.3","type":"blocks","created_at":"2026-02-01T12:08:51.430234668-05:00","created_by":"Vincent Desjardins"}]}
{"id":"nix-config-5sr","title":"feat: opencode-sandbox - support arbitrary commands, default to 'opencode'","description":"Enable flexible command execution:\n- If no COMMAND given, default to launching 'opencode'\n- Support arbitrary commands: opencode-sandbox python3 -c \"print('hi')\"\n- Use $SHELL from environment for interactive shells\n- Pass all environment variables from host to sandbox\n\nImplementation:\n- Check COMMAND_ARGS array length\n- If empty, set COMMAND_ARGS=(opencode)\n- Otherwise pass COMMAND_ARGS directly to bwrap\n- Export full environment to bwrap via --setenv\n\nThis replaces current fixed shell launching behavior","status":"closed","priority":2,"issue_type":"task","owner":"vdesjardins@gmail.com","created_at":"2026-01-27T20:23:24.487915777-05:00","created_by":"Vincent Desjardins","updated_at":"2026-01-27T20:27:50.076107675-05:00","closed_at":"2026-01-27T20:27:50.076107675-05:00","close_reason":"Command execution implemented: defaults to 'opencode' if no command given, supports arbitrary commands via COMMAND_ARGS passthrough, passes all environment variables via --clearenv + env loop. Respects $SHELL environment variable.","dependencies":[{"issue_id":"nix-config-5sr","depends_on_id":"nix-config-2sp","type":"blocks","created_at":"2026-01-27T20:23:24.679428583-05:00","created_by":"Vincent Desjardins"},{"issue_id":"nix-config-5sr","depends_on_id":"nix-config-p6t","type":"discovered-from","created_at":"2026-01-27T20:23:24.905452027-05:00","created_by":"Vincent Desjardins"}]}
{"id":"nix-config-5wk","title":"Create home-manager module for beads_viewer","description":"Bootstrap and create a home-manager module for beads_viewer. Use docs/HM_MODULE_BOOTSTRAP.md as reference. Wire up configuration options for the viewer.","status":"closed","priority":2,"issue_type":"task","owner":"vdesjardins@gmail.com","created_at":"2026-01-31T08:07:30.562320982-05:00","created_by":"Vincent Desjardins","updated_at":"2026-01-31T08:32:26.58689832-05:00","closed_at":"2026-01-31T08:32:26.58689832-05:00","close_reason":"Home-manager module for beads_viewer created and wired into roles.ai.tools","dependencies":[{"issue_id":"nix-config-5wk","depends_on_id":"nix-config-0ql","type":"discovered-from","created_at":"2026-01-31T08:07:41.324721585-05:00","created_by":"Vincent Desjardins"}]}
{"id":"nix-config-70y","title":"remove: opencode-sandbox-list - delete script and references","description":"Remove metadata tracking functionality:\n- Delete packages/opencode-sandbox/bin/opencode-sandbox-list\n- Remove opencode-sandbox-list installation from package.nix\n- Remove any references to jq (no longer needed)\n\nThe script tracked sandbox metadata but this is replaced by ephemeral design","status":"closed","priority":2,"issue_type":"task","owner":"vdesjardins@gmail.com","created_at":"2026-01-27T20:23:24.539109598-05:00","created_by":"Vincent Desjardins","updated_at":"2026-01-27T20:28:15.795888501-05:00","closed_at":"2026-01-27T20:28:15.795888501-05:00","close_reason":"Deleted packages/opencode-sandbox/bin/opencode-sandbox-list - metadata tracking functionality no longer needed in ephemeral sandbox design.","dependencies":[{"issue_id":"nix-config-70y","depends_on_id":"nix-config-p6t","type":"discovered-from","created_at":"2026-01-27T20:23:24.9568902-05:00","created_by":"Vincent Desjardins"}]}
{"id":"nix-config-77l","title":"Fix nushell deprecated flag: get -i to get -o","status":"closed","priority":2,"issue_type":"bug","owner":"vdesjardins@gmail.com","created_at":"2026-02-01T20:07:10.787025966-05:00","created_by":"Vincent Desjardins","updated_at":"2026-02-01T20:08:34.889778968-05:00","closed_at":"2026-02-01T20:08:34.889778968-05:00","close_reason":"Fixed: nushell deprecated get -i flag replaced with get -o (optional) flag"}
{"id":"nix-config-7ag","title":"Replace dev-browser with agent-browser","status":"closed","priority":2,"issue_type":"epic","owner":"vdesjardins@gmail.com","created_at":"2026-01-30T19:38:11.614221801-05:00","created_by":"Vincent Desjardins","updated_at":"2026-01-30T20:24:22.166753622-05:00","closed_at":"2026-01-30T20:24:22.166753622-05:00","close_reason":"✅ Epic completed: Agent-browser fully integrated and dev-browser successfully removed. All work items completed."}
{"id":"nix-config-7ca","title":"Make passage credentials host-agnostic across all modules","status":"closed","priority":2,"issue_type":"task","owner":"vdesjardins@gmail.com","created_at":"2026-02-01T08:24:29.933415765-05:00","created_by":"Vincent Desjardins","updated_at":"2026-02-01T10:43:24.823077856-05:00","closed_at":"2026-02-01T10:43:24.823077856-05:00","close_reason":"completed"}
{"id":"nix-config-7cm","title":"Add atuin home-manager module with zsh and nushell support","status":"closed","priority":2,"issue_type":"epic","owner":"vdesjardins@gmail.com","created_at":"2026-01-28T07:44:45.437479036-05:00","created_by":"Vincent Desjardins","updated_at":"2026-02-01T11:01:43.20979713-05:00","closed_at":"2026-02-01T11:01:43.20979713-05:00","close_reason":"Closed"}
{"id":"nix-config-7in","title":"Atuin: sync history limit to 50k, add import docs, enable cd filtering","status":"closed","priority":2,"issue_type":"task","owner":"vdesjardins@gmail.com","created_at":"2026-02-01T18:10:08.757969989-05:00","created_by":"Vincent Desjardins","updated_at":"2026-02-01T18:10:32.421153573-05:00","closed_at":"2026-02-01T18:10:32.421153573-05:00","close_reason":"Completed: history limit synced to 50k, import docs added, cd filtering enabled for cross-machine sync"}
{"id":"nix-config-7u7","title":"Add passage package to host configuration","description":"Add passage (password manager with age) to system packages so it's available at the NixOS level, not just in home-manager. This is needed for activation scripts to fetch secrets from passage during system rebuilds.","status":"closed","priority":2,"issue_type":"task","owner":"vdesjardins@gmail.com","created_at":"2026-02-01T08:25:44.085848117-05:00","created_by":"Vincent Desjardins","updated_at":"2026-02-01T08:26:12.360219167-05:00","closed_at":"2026-02-01T08:26:12.360219167-05:00","close_reason":"Added passage, age-plugin-yubikey, and rage to system packages in debugging.nix"}
{"id":"nix-config-7vb","title":"Add Tokyo Night theme to atuin with bold vibrant colors","status":"closed","priority":2,"issue_type":"feature","owner":"vdesjardins@gmail.com","created_at":"2026-02-01T18:31:48.007805994-05:00","created_by":"Vincent Desjardins","updated_at":"2026-02-01T18:36:52.428211871-05:00","closed_at":"2026-02-01T18:36:52.428211871-05:00","close_reason":"Fixed: Tokyo Night theme properly implemented as embedded RGB struct in atuin settings"}
{"id":"nix-config-8a9","title":"auto approve opencode-sandbox asking for permission to Access external directory, /tmp for example","description":"goal is to not get prompted and let AI agent run to completion","status":"closed","priority":2,"issue_type":"task","owner":"vdesjardins@gmail.com","created_at":"2026-01-31T08:28:13.826830124-05:00","created_by":"Vincent Desjardins","updated_at":"2026-02-01T10:47:01.656414986-05:00","closed_at":"2026-02-01T10:47:01.656414986-05:00","close_reason":"will be superseded and fix when rx0 is completed"}
{"id":"nix-config-8ft","title":"Fix pre-commit hook step: use prek instead of pre-commit","status":"closed","priority":2,"issue_type":"bug","owner":"vdesjardins@gmail.com","created_at":"2026-01-29T20:40:05.795631487-05:00","created_by":"Vincent Desjardins","updated_at":"2026-02-01T10:50:27.754144645-05:00","closed_at":"2026-02-01T10:50:27.754144645-05:00","close_reason":"already fixed - workflow uses prek instead of pre-commit"}
{"id":"nix-config-8sx","title":"Implement overlay setup and helper functions","description":"Implement packages/opencode-sandbox/lib.nix with helper functions: generate-sandbox-id (UUID), create-overlay (mount overlayfs for /nix/store and home), setup-sandbox-dir (create directory structure), write-metadata (JSON: id, created_at, pid, status), check-is-alive (PID check), cleanup-old-sandboxes (remove exited sandboxes after 7 days). Use $XDG_CACHE_HOME/opencode/sandboxes/{id}/ for overlays.","status":"closed","priority":1,"issue_type":"task","owner":"vdesjardins@gmail.com","created_at":"2026-01-26T20:21:02.0066022-05:00","created_by":"Vincent Desjardins","updated_at":"2026-01-26T21:00:34.776864437-05:00","closed_at":"2026-01-26T21:00:34.776864437-05:00","close_reason":"Implemented packages/opencode-sandbox/lib.nix with all helper functions: generate-sandbox-id (UUID), get-xdg-cache-home, check-is-alive (PID tracking), write-metadata (JSON persistence), create-nix-store-overlay, create-home-overlay, cleanup-old-sandboxes (7-day auto-cleanup), get-store-changes-size. Integrated lib.nix into package.nix. All helpers use proper error handling and shell scripting. Package builds successfully, pre-commit passes.","dependencies":[{"issue_id":"nix-config-8sx","depends_on_id":"nix-config-3a9","type":"blocks","created_at":"2026-01-26T20:21:27.778356166-05:00","created_by":"Vincent Desjardins"}]}
{"id":"nix-config-8x4","title":"chore: opencode-sandbox - pre-commit fixes, INTENTS file, commit","description":"Final cleanup and verification:\n1. Run: nix develop \u0026\u0026 pre-commit run -a\n2. Fix any shfmt formatting, shellcheck warnings\n3. Fix any alejandra nix formatting issues\n4. Create INTENTS-YYYY-MM-DD-HH-mm.md with conversation summary\n5. Verify build: nix build .#opencode-sandbox\n6. Stage changes: git add packages/opencode-sandbox/\n\nDO NOT commit - leave staged for user to commit manually","status":"closed","priority":2,"issue_type":"task","owner":"vdesjardins@gmail.com","created_at":"2026-01-27T20:23:24.624018176-05:00","created_by":"Vincent Desjardins","updated_at":"2026-01-27T20:44:51.483169736-05:00","closed_at":"2026-01-27T20:44:51.483169736-05:00","close_reason":"Epic complete: opencode-sandbox redesigned successfully. All 8 tasks closed. Bug fixed: interactive shell default now works. Commit wxkmymzu created. nix flake check passes. Ready for use.","dependencies":[{"issue_id":"nix-config-8x4","depends_on_id":"nix-config-k6j","type":"blocks","created_at":"2026-01-27T20:23:24.831012469-05:00","created_by":"Vincent Desjardins"},{"issue_id":"nix-config-8x4","depends_on_id":"nix-config-p6t","type":"discovered-from","created_at":"2026-01-27T20:23:25.027900805-05:00","created_by":"Vincent Desjardins"}]}
{"id":"nix-config-9gc","title":"Configure 2-layer logging for yolo-mode like code-validator","status":"closed","priority":2,"issue_type":"task","owner":"vdesjardins@gmail.com","created_at":"2026-01-29T19:22:24.491007527-05:00","created_by":"Vincent Desjardins","updated_at":"2026-01-29T20:24:37.174710319-05:00","closed_at":"2026-01-29T20:24:37.174710319-05:00","close_reason":"Successfully implemented 2-layer logging for yolo-mode plugin. Plugin now auto-allows bash/shell commands when OPENCODE_YOLO=1 using proper SDK method and request structure."}
{"id":"nix-config-9mh","title":"Set up passage credential entry for OpenCode nginx htpasswd","status":"closed","priority":1,"issue_type":"task","owner":"vdesjardins@gmail.com","created_at":"2026-02-01T09:29:58.156030544-05:00","created_by":"Vincent Desjardins","updated_at":"2026-02-01T10:43:24.821498891-05:00","closed_at":"2026-02-01T10:43:24.821498891-05:00","close_reason":"completed"}
{"id":"nix-config-a26","title":"Modify opencode-sandbox to start opencode in yolo mode","description":"we want to execute opencode without any confirmation prompt when running external commands.","status":"closed","priority":2,"issue_type":"feature","owner":"vdesjardins@gmail.com","created_at":"2026-01-28T21:04:30.096095093-05:00","created_by":"Vincent Desjardins","updated_at":"2026-01-29T06:58:09.403991812-05:00","closed_at":"2026-01-29T06:58:09.403991812-05:00","close_reason":"Implemented yolo mode for opencode-sandbox with --yolo flag, OPENCODE_YOLO env var, and yolo-mode plugin that auto-allows all commands without confirmation prompts"}
{"id":"nix-config-a93","title":"OPNsense Optimization: Configure memory limits and threading (25% mem, 4 threads, 0.5 ratio)","status":"closed","priority":2,"issue_type":"task","owner":"vdesjardins@gmail.com","created_at":"2026-01-31T11:28:27.99302245-05:00","created_by":"Vincent Desjardins","updated_at":"2026-01-31T11:32:52.717661115-05:00","closed_at":"2026-01-31T11:32:52.717661115-05:00","close_reason":"Closed"}
{"id":"nix-config-ack","title":"OPNsense Optimization: Verify improvements and monitor stability (7+ days)","notes":"Monitoring setup complete. Run: /home/vince/opnsense-monitor.sh -p 4422 10.0.0.1","status":"in_progress","priority":2,"issue_type":"task","owner":"vdesjardins@gmail.com","created_at":"2026-01-31T11:28:29.142638653-05:00","created_by":"Vincent Desjardins","updated_at":"2026-01-31T11:33:20.156163235-05:00"}
{"id":"nix-config-aks","title":"OPNsense Optimization: Disable EVE file logging, keep syslog only","status":"closed","priority":2,"issue_type":"task","owner":"vdesjardins@gmail.com","created_at":"2026-01-31T11:28:28.168156944-05:00","created_by":"Vincent Desjardins","updated_at":"2026-01-31T11:32:52.71930267-05:00","closed_at":"2026-01-31T11:32:52.71930267-05:00","close_reason":"Closed"}
{"id":"nix-config-b0u","title":"Implement openclaw package and home-manager module","description":"Test that yolo mode works by: 1) Building home-manager config with make hm/apply, 2) Run opencode with a bash command request (e.g., 'search for blabla'), 3) Verify command executes without prompts, 4) Check logs show '[YoloMode] Auto-allowing command' messages. Both hook implementation and OPENCODE_YOLO variable are now in place.","status":"closed","priority":2,"issue_type":"task","owner":"vdesjardins@gmail.com","created_at":"2026-01-29T08:25:34.528576713-05:00","created_by":"Vincent Desjardins","updated_at":"2026-01-30T07:49:59.547877578-05:00","closed_at":"2026-01-30T07:49:59.547877578-05:00","close_reason":"All subtasks completed: package created, home-manager module implemented, and integration tested","dependencies":[{"issue_id":"nix-config-b0u","depends_on_id":"nix-config-dab","type":"blocks","created_at":"2026-01-29T08:25:45.479597105-05:00","created_by":"Vincent Desjardins"},{"issue_id":"nix-config-b0u","depends_on_id":"nix-config-rki","type":"blocks","created_at":"2026-01-29T08:25:45.505707107-05:00","created_by":"Vincent Desjardins"}]}
{"id":"nix-config-b24","title":"Rename opencode-sandbox to opencode-sandbox.sh for linting coverage","status":"open","priority":2,"issue_type":"task","owner":"vdesjardins@gmail.com","created_at":"2026-02-01T11:27:01.376851665-05:00","created_by":"Vincent Desjardins","updated_at":"2026-02-01T11:27:01.376851665-05:00"}
{"id":"nix-config-bx5","title":"Add JavaScript configuration to .editorconfig","description":"Add configuration section for JavaScript/TypeScript files to .editorconfig with:\n- indent_style = space\n- indent_size = 2\n- insert_final_newline = true\n- charset = utf-8\n\nThis will apply to all *.js, *.jsx, *.ts, *.tsx, and *.json files in the project.","status":"closed","priority":2,"issue_type":"task","owner":"vdesjardins@gmail.com","created_at":"2026-01-29T07:34:11.955616206-05:00","created_by":"Vincent Desjardins","updated_at":"2026-01-31T12:02:01.531507146-05:00","closed_at":"2026-01-31T12:02:01.531507146-05:00","close_reason":"Added JavaScript/TypeScript configuration to .editorconfig with 2-space indentation, final newlines, and UTF-8 charset"}
{"id":"nix-config-bxv","title":"Implement opencode-sandbox-list discovery command","description":"Implement packages/opencode-sandbox/bin/opencode-sandbox-list. Scan $XDG_CACHE_HOME/opencode/sandboxes/, read .metadata JSON files, check if PID is alive. Display formatted table: ID, Created, PID, Status (running/exited), Store Changes Size.","status":"closed","priority":2,"issue_type":"task","owner":"vdesjardins@gmail.com","created_at":"2026-01-26T20:21:02.920741644-05:00","created_by":"Vincent Desjardins","updated_at":"2026-01-26T21:02:26.138481472-05:00","closed_at":"2026-01-26T21:02:26.138481472-05:00","close_reason":"Implemented packages/opencode-sandbox/bin/opencode-sandbox-list command. Scans XDG_CACHE_HOME/opencode/sandboxes/, reads .metadata JSON files, checks process status (running/exited), calculates nix-store-changes size, displays formatted table with: ID, Created, PID, Status, Store Changes Size. Includes human-readable size formatting (B/KB/MB/GB). Package builds successfully, pre-commit formatting passes.","dependencies":[{"issue_id":"nix-config-bxv","depends_on_id":"nix-config-8sx","type":"blocks","created_at":"2026-01-26T20:21:37.953035069-05:00","created_by":"Vincent Desjardins"}]}
{"id":"nix-config-c46","title":"Replace custom atuin daemon with upstream home-manager implementation","status":"closed","priority":2,"issue_type":"task","owner":"vdesjardins@gmail.com","created_at":"2026-02-01T19:52:10.821361446-05:00","created_by":"Vincent Desjardins","updated_at":"2026-02-01T19:53:01.887072178-05:00","closed_at":"2026-02-01T19:53:01.887072178-05:00","close_reason":"Completed: Removed custom daemon implementations and replaced with upstream home-manager daemon option"}
{"id":"nix-config-ckf","title":"Configure OPENCODE_SERVER_PASSWORD environment variable for zsh and nushell in opencode hm module","status":"closed","priority":2,"issue_type":"task","owner":"vdesjardins@gmail.com","created_at":"2026-01-31T18:57:54.406692304-05:00","created_by":"Vincent Desjardins","updated_at":"2026-01-31T18:59:38.946478011-05:00","closed_at":"2026-01-31T18:59:38.946478011-05:00","close_reason":"OPENCODE_SERVER_PASSWORD environment variable added to home.sessionVariables in opencode hm module"}
{"id":"nix-config-cqw","title":"Remove yolo-plugin","status":"closed","priority":2,"issue_type":"task","owner":"vdesjardins@gmail.com","created_at":"2026-02-01T10:31:04.837058818-05:00","created_by":"Vincent Desjardins","updated_at":"2026-02-01T10:32:24.973512394-05:00","closed_at":"2026-02-01T10:32:24.973512394-05:00","close_reason":"Removed yolo-mode.js plugin and all references from opencode configuration to enforce explicit permission model instead of environment variable overrides"}
{"id":"nix-config-ct9","title":"Expose OpenCode web service via Nginx with TLS and basic auth","status":"closed","priority":2,"issue_type":"epic","owner":"vdesjardins@gmail.com","created_at":"2026-01-31T19:25:32.663135718-05:00","created_by":"Vincent Desjardins","updated_at":"2026-01-31T19:30:39.185119458-05:00","closed_at":"2026-01-31T19:30:39.185119458-05:00","close_reason":"Completed all subtasks: Nginx vhost setup, ACME integration, and OpenCode port configuration"}
{"id":"nix-config-d09","title":"CRITICAL: Use jujutsu (jj) for ALL version control - never use git","description":"Project now uses jujutsu (jj) as the primary VCS, not git. This is a hard requirement.\n\nRULES FOR ALL AGENTS:\n- ONLY use jujutsu (jj) commands for version control operations\n- NEVER run git commands (git add, git commit, git push, git status, etc.)\n- If git is mentioned in instructions or context, interpret as jj equivalent\n- Always use 'jj new -A @' to create new changes before editing\n- Use 'jj log' instead of 'git log'\n- Use 'jj describe' instead of 'git commit --amend'\n- Use 'jj sync' for pushing/syncing changes\n- If uncertain about a git command, ask or check the jj skill\n\nThis is not optional. Git should not be used in this project.","status":"closed","priority":0,"issue_type":"task","owner":"vdesjardins@gmail.com","created_at":"2026-01-28T07:33:41.317302268-05:00","created_by":"Vincent Desjardins","updated_at":"2026-01-28T20:54:32.201870882-05:00","closed_at":"2026-01-28T20:54:32.201870882-05:00","close_reason":"✅ Task Complete: Enhanced jujutsu module rules for AI agent workflow.\n\nChanges made to home/modules/modules/shell/tools/jujutsu/default.nix:\n- Added pre-task workflow: check jj status and create new change if needed\n- Added post-INTENTS workflow: run jj describe with conventional-commits format\n- Enhanced rules section with step-by-step guidance for agents\n- Updated cheat sheet with essential jj commands\n\nCommit: omstllvm - '✨ feat(jujutsu): enhance AI agent workflow rules with change isolation and commit message guidance'\n\nThis ensures proper change isolation and consistent, well-formatted commit messages across all AI-assisted development work."}
{"id":"nix-config-d2f","title":"Fix: Ctrl-j tmux pane navigation not working inside opencode-sandbox","description":"When running opencode-sandbox, the tmux keybinding Ctrl-j (to move between panes) is not working. This suggests either:\n- Ctrl-j is being captured by opencode instead of tmux\n- The keybinding is not being properly passed through the sandbox isolation\n- Terminal emulation inside the sandbox is not capturing the key correctly\n\nNeed to investigate and fix so standard tmux navigation works inside the sandbox environment.","status":"closed","priority":2,"issue_type":"bug","owner":"vdesjardins@gmail.com","created_at":"2026-01-28T07:37:25.913679093-05:00","created_by":"Vincent Desjardins","updated_at":"2026-02-01T10:45:07.273723397-05:00","closed_at":"2026-02-01T10:45:07.273723397-05:00","close_reason":"not a bug"}
{"id":"nix-config-dab","title":"Implement permission.ask hook in yolo-mode plugin","description":"Rewrite the yolo-mode plugin to use the correct OpenCode plugin API. Current hook: 'permission(request)' should be: '\"permission.ask\"(input, output)'. When OPENCODE_YOLO=1, the hook should set output.status = 'allow' to auto-approve bash/shell commands.","status":"closed","priority":1,"issue_type":"task","owner":"vdesjardins@gmail.com","created_at":"2026-01-29T08:25:33.78707986-05:00","created_by":"Vincent Desjardins","updated_at":"2026-01-29T20:24:59.496589474-05:00","closed_at":"2026-01-29T20:24:59.496589474-05:00","close_reason":"Successfully implemented permission.asked event handler in yolo-mode plugin. When OPENCODE_YOLO=1, bash/shell commands are auto-approved by calling client.postSessionIdPermissionsPermissionId() with response='always'. Tested and working.","dependencies":[{"issue_id":"nix-config-dab","depends_on_id":"nix-config-f90","type":"blocks","created_at":"2026-01-29T08:25:45.425653014-05:00","created_by":"Vincent Desjardins"}]}
{"id":"nix-config-dfu","title":"opencode-sandbox: overlayfs mount failure for /nix/store","description":"opencode-sandbox fails at runtime with overlayfs mount error. Error: 'Failed to mount overlayfs for /nix/store'. This appears to be a runtime issue after the binary path substitution fix. Need to investigate why overlayfs mounting is failing when creating the sandbox.","notes":"Root cause identified: overlayfs mount requires root privileges or setuid binary. The script attempts to mount overlayfs at /tmp/.opencode-$sandbox_id/nix-store without proper capabilities. Error: 'must be superuser to use mount'. \n\nPossible solutions:\n1. Make opencode-sandbox a setuid binary (security implications)\n2. Use sudo (requires sudoers configuration)\n3. Use bubblewrap's built-in features (--tmpfs, --bind) directly instead of pre-mounting overlays\n4. Create a setuid helper wrapper for mounting\n\nCurrent architecture: opencode-sandbox -\u003e mounts overlayfs -\u003e launches bubblewrap with --bind\n\nNeed design decision on how to handle privileged mount operation.","status":"closed","priority":2,"issue_type":"bug","owner":"vdesjardins@gmail.com","created_at":"2026-01-27T07:31:13.556441566-05:00","created_by":"Vincent Desjardins","updated_at":"2026-01-27T07:43:36.791426951-05:00","closed_at":"2026-01-27T07:43:36.791426951-05:00","close_reason":"Fixed overlayfs mount failure by using writable tmpfs for /nix/store instead of privileged mount operations. Now nix commands can execute inside the sandbox without requiring root."}
{"id":"nix-config-dzi","title":"Update opencode.nix with passage-managed credentials config","description":"Implement the Nix configuration changes to opencode.nix following the plan:\n\nCHANGES REQUIRED:\n1. Add let-block at file top with:\n   - inherit (config.networking) hostName;\n   - credsDir = \"/var/services/opencode\";\n\n2. Update services.nginx.virtualHosts.\"opencode.kube-stack.org\".locations.\"/\":\n   - Remove: basicAuth.\"admin\" = \"opencode\"; (if present)\n   - Add: basicAuthFile = \"${credsDir}/nginx-htpasswd\";\n   - Keep: proxyPass, proxyWebsockets, recommendedProxySettings\n\n3. Add system.activationScripts.secrets-opencode.text with:\n   - export HOME=/root (required for remote rebuilds)\n   - mkdir -p ${credsDir}\n   - chmod 700 ${credsDir}\n   - passage fetch into ${credsDir}/nginx-htpasswd\n\nPATTERNS TO FOLLOW:\n- Reference: acme.nix activation script (lines 21-30)\n- Reference: frigate.nix activation script (lines 333-342)\n\nFILE: hosts/modules/linux/shared/opencode.nix\nTESTS: \n- nix flake check --no-build (syntax)\n- alejandra format check\n- systemctl cat system-secrets-opencode.service (verify script)","status":"closed","priority":1,"issue_type":"task","owner":"vdesjardins@gmail.com","created_at":"2026-02-01T09:30:13.023467773-05:00","created_by":"Vincent Desjardins","updated_at":"2026-02-01T09:39:50.866445972-05:00","closed_at":"2026-02-01T09:39:50.866445972-05:00","close_reason":"Successfully updated opencode.nix with passage-managed credentials. Config includes let-block, basicAuthFile reference, and system activation script to fetch credentials from passage at rebuild time. Nix syntax verified.","dependencies":[{"issue_id":"nix-config-dzi","depends_on_id":"nix-config-4wx","type":"blocks","created_at":"2026-02-01T09:30:30.493729281-05:00","created_by":"Vincent Desjardins"}]}
{"id":"nix-config-ebc","title":"Investigate why HTTP basic auth is not working in opencode.nix","description":"HTTP basic auth is not working in opencode.nix nginx configuration.\n\nROOT CAUSE: basicAuth is configured at virtualHost level while using raw extraConfig with proxy_pass. The NixOS nginx module may not properly apply basic auth when mixing these configuration styles.\n\nINVESTIGATION FINDINGS:\n- No other services in the codebase use basicAuth (only opencode.nix attempts it)\n- All working proxy configurations use either:\n  * proxyPass attribute with recommendedProxySettings (Grafana pattern)\n  * proxyPass + extraConfig with custom headers (Frigate pattern)\n- Current setup mixes styles: basicAuth at virtualHost level + raw proxy_pass in extraConfig\n\nSOLUTION: Move basicAuth into the location block and use NixOS module attributes instead of raw extraConfig. This follows the successful Grafana pattern already in use.\n\nAFFECTED FILE: hosts/modules/linux/shared/opencode.nix:10-24","status":"closed","priority":2,"issue_type":"bug","owner":"vdesjardins@gmail.com","created_at":"2026-02-01T08:53:44.829078602-05:00","created_by":"Vincent Desjardins","updated_at":"2026-02-01T08:57:42.832071495-05:00","closed_at":"2026-02-01T08:57:42.832071495-05:00","close_reason":"Fixed: moved basicAuth from virtualHost level to location level and switched to NixOS module attributes (proxyPass, proxyWebsockets, recommendedProxySettings) following Grafana pattern. This properly applies basic authentication to the opencode proxy."}
{"id":"nix-config-egt","title":"yolo mode in sandbox is not working","description":"For example, search for a string prompt user for permission to use grep","status":"closed","priority":2,"issue_type":"bug","owner":"vdesjardins@gmail.com","created_at":"2026-01-29T07:44:42.684743575-05:00","created_by":"Vincent Desjardins","updated_at":"2026-01-29T08:09:12.004425934-05:00","closed_at":"2026-01-29T08:09:12.004425934-05:00","close_reason":"Closed"}
{"id":"nix-config-et6","title":"opencode-sandbox: automatically enter sandbox instead of just creating it","status":"closed","priority":2,"issue_type":"task","owner":"vdesjardins@gmail.com","created_at":"2026-01-27T08:23:08.05561824-05:00","created_by":"Vincent Desjardins","updated_at":"2026-01-27T08:42:18.839549831-05:00","closed_at":"2026-01-27T08:42:18.839549831-05:00","close_reason":"Fixed trap handler variable scope by using inline trap with explicit variable expansion. Sandbox now properly enters interactive shell and cleans up after user exits."}
{"id":"nix-config-eu3","title":"Create core atuin home-manager module","description":"Create home/modules/modules/shell/tools/atuin/default.nix that wraps the official home-manager atuin module. Configure basic settings and ensure package is included. History search should match current zsh/fzf behavior (or use atuin defaults if equivalent).","status":"open","priority":2,"issue_type":"task","owner":"vdesjardins@gmail.com","created_at":"2026-01-28T07:44:49.635668387-05:00","created_by":"Vincent Desjardins","updated_at":"2026-01-28T07:44:49.635668387-05:00","dependencies":[{"issue_id":"nix-config-eu3","depends_on_id":"nix-config-7cm","type":"blocks","created_at":"2026-01-28T07:44:52.733330147-05:00","created_by":"Vincent Desjardins"}]}
{"id":"nix-config-f90","title":"Fix yolo-mode plugin to use correct OpenCode API","description":"The yolo-mode plugin implements a non-existent 'permission' hook instead of the correct 'permission.ask' hook from the OpenCode API. This causes yolo mode to be completely non-functional - users still get prompted for permissions even when yolo mode is enabled. The hook signature is also incorrect (needs input/output parameters, not request).","status":"closed","priority":1,"issue_type":"bug","owner":"vdesjardins@gmail.com","created_at":"2026-01-29T08:25:31.4005042-05:00","created_by":"Vincent Desjardins","updated_at":"2026-01-29T18:59:08.0705237-05:00","closed_at":"2026-01-29T18:59:08.0705237-05:00","close_reason":"Closed"}
{"id":"nix-config-ffi","title":"Add yocr alias for ocr yolo mode","notes":"Added yocr alias: export OPENCODE_PERMISSION='{\"*\": \"allow\"}' \u0026\u0026 opencode run","status":"closed","priority":2,"issue_type":"task","owner":"vdesjardins@gmail.com","created_at":"2026-02-01T10:38:58.148341049-05:00","created_by":"Vincent Desjardins","updated_at":"2026-02-01T11:16:52.410460193-05:00","closed_at":"2026-02-01T10:59:40.673918248-05:00","close_reason":"Closed"}
{"id":"nix-config-g0j","title":"Build and test home-manager with beads_viewer","description":"Build home-manager configuration with beads_viewer module enabled. Test with 'nix build .#homeConfigurations.vince.activationPackage' or similar after wiring into role.","status":"closed","priority":2,"issue_type":"task","owner":"vdesjardins@gmail.com","created_at":"2026-01-31T08:07:37.883249859-05:00","created_by":"Vincent Desjardins","updated_at":"2026-01-31T08:36:03.793731548-05:00","closed_at":"2026-01-31T08:36:03.793731548-05:00","close_reason":"Home-manager configuration successfully evaluates with beads_viewer module enabled. Module uses my-packages.beads_viewer for proper package exposure.","dependencies":[{"issue_id":"nix-config-g0j","depends_on_id":"nix-config-rkv","type":"blocks","created_at":"2026-01-31T08:07:41.407703143-05:00","created_by":"Vincent Desjardins"}]}
{"id":"nix-config-h7q","title":"Remove sessionVariable from OpenCode home-manager module","description":"Remove home.sessionVariables.OPENCODE_SERVER_PASSWORD from home/modules/modules/shell/tools/opencode/default.nix line 179. This variable is no longer needed since the Nginx proxy will handle authentication at the gateway level instead of the application level.","notes":"Since proxy handles auth, remove this line. Keep the module otherwise intact.","status":"closed","priority":2,"issue_type":"task","owner":"vdesjardins@gmail.com","created_at":"2026-01-31T19:25:36.37786866-05:00","created_by":"Vincent Desjardins","updated_at":"2026-01-31T19:28:14.520620193-05:00","closed_at":"2026-01-31T19:28:14.520620193-05:00","close_reason":"Completed removal of sessionVariable from OpenCode home-manager module"}
{"id":"nix-config-hft","title":"Add zsh and nushell aliases for beads","description":"Add shell aliases for beads commands:\n- bl → beads list\n- blt → beads list --tree\n\nSupport both zsh and nushell shells.","status":"closed","priority":3,"issue_type":"task","owner":"vdesjardins@gmail.com","created_at":"2026-01-31T08:09:43.095768715-05:00","created_by":"Vincent Desjardins","updated_at":"2026-01-31T08:55:16.982051174-05:00","closed_at":"2026-01-31T08:55:16.982051174-05:00","close_reason":"Shell aliases for beads configured in the beads plugin module: bl=beads list, blt=beads list --tree. Available in zsh and nushell when beads is enabled."}
{"id":"nix-config-hve","title":"Test and verify OpenCode nginx basicAuth with passage credentials","description":"Verify that the passage-managed credentials work correctly after applying the Nix config.\n\nDEPLOYMENT STEPS:\n1. Ensure passage entry exists: bd show nix-config-4wx\n2. Run: make host/apply\n3. Wait for system rebuild and activation\n\nVERIFICATION CHECKLIST:\n□ 1. File was created with correct permissions:\n     sudo ls -la /var/services/opencode/nginx-htpasswd\n     Expected: -rw------- (600) or similar, root:root\n\n□ 2. Activation script ran successfully:\n     sudo systemctl status system-secrets-opencode.service\n     Expected: Loaded, active\n\n□ 3. htpasswd file has correct content:\n     sudo cat /var/services/opencode/nginx-htpasswd\n     Expected: admin:$2b$05$...\n\n□ 4. nginx reloaded config:\n     sudo systemctl status nginx\n     Expected: active, no errors\n\n□ 5. Test HTTP basic auth:\n     curl -i https://opencode.kube-stack.org/ \n     Expected: 401 Unauthorized with WWW-Authenticate header\n     \n□ 6. Test with correct credentials:\n     curl -u admin:opencode https://opencode.kube-stack.org/\n     Expected: 200 OK or proxy response (not 401)\n     \n□ 7. Test with wrong credentials:\n     curl -u admin:wrongpass https://opencode.kube-stack.org/\n     Expected: 401 Unauthorized\n\n□ 8. Browser test (web UI):\n     Navigate to https://opencode.kube-stack.org/\n     Expected: Auth popup appears\n     Login with admin / opencode\n     Expected: OpenCode app loads\n\nTROUBLESHOOTING:\n- If activation script fails: Check passage entry exists (nix-config-4wx)\n- If 401 persists: Verify /var/services/opencode/nginx-htpasswd exists and is readable by nginx\n- If nginx errors: Check journalctl -u nginx\n- If permissions wrong: activation script may not have run (check system-secrets-opencode.service)\n\nSUCCESS CRITERIA:\n- ✅ Auth popup required to access opencode\n- ✅ Credentials admin:opencode work\n- ✅ Wrong credentials rejected\n- ✅ No nginx errors in logs","status":"closed","priority":1,"issue_type":"task","owner":"vdesjardins@gmail.com","created_at":"2026-02-01T09:30:26.822681201-05:00","created_by":"Vincent Desjardins","updated_at":"2026-02-01T10:42:34.465217666-05:00","closed_at":"2026-02-01T10:42:34.465217666-05:00","close_reason":"tested and completed","dependencies":[{"issue_id":"nix-config-hve","depends_on_id":"nix-config-dzi","type":"blocks","created_at":"2026-02-01T09:30:30.519001732-05:00","created_by":"Vincent Desjardins"}]}
{"id":"nix-config-i4q","title":"Implement opencode-sandbox main script","description":"Implement packages/opencode-sandbox/bin/opencode-sandbox main script. Logic: (1) Generate sandbox UUID, (2) Capture $PWD and home directory paths, (3) Create overlay for /nix/store (lower=/nix/store, upper=$XDG_CACHE_HOME/opencode/{id}/nix-store-changes, merged=/tmp/.opencode-{id}/nix-store), (4) Create CoW overlay for home (lower=~/, upper=$XDG_CACHE_HOME/opencode/{id}/home-changes, merged=/tmp/.opencode-{id}/home), (5) Write .metadata file, (6) Launch bubblewrap with: --bind merged-nix-store /nix/store, --bind merged-home /home/opencode, --ro-bind ~/.config/opencode /.opencode/.config/opencode, --ro-bind ~/.config/zsh /.opencode/.config/zsh, --bind $PWD /workspace, --tmpfs /tmp, (7) Drop to zsh shell with HOME=/.opencode/opencode.","status":"closed","priority":1,"issue_type":"task","owner":"vdesjardins@gmail.com","created_at":"2026-01-26T20:21:02.377158338-05:00","created_by":"Vincent Desjardins","updated_at":"2026-01-26T21:01:47.283038391-05:00","closed_at":"2026-01-26T21:01:47.283038391-05:00","close_reason":"Implemented packages/opencode-sandbox/bin/opencode-sandbox main script with full orchestration: generates UUID sandbox ID, captures PWD, creates CoW overlays for both /nix/store and home directory, mounts PWD as /workspace (RW), mounts home dotfiles (RO), uses bubblewrap to launch zsh shell with proper environment. Includes proper error handling, cleanup handlers, and output feedback. Package builds successfully with variable substitution. Pre-commit formatting passes.","dependencies":[{"issue_id":"nix-config-i4q","depends_on_id":"nix-config-8sx","type":"blocks","created_at":"2026-01-26T20:21:32.864282858-05:00","created_by":"Vincent Desjardins"}]}
{"id":"nix-config-j7c","title":"Integrate sandbox into flake and test multi-sandbox support","description":"Add packages.opencode-sandbox to flake.nix outputs. Test multi-sandbox functionality: (1) Create two concurrent sandboxes from different directories, (2) Verify $PWD mount works (edit file in /workspace, see changes on host), (3) Verify home CoW isolation (install npm package, confirm node_modules isolated per sandbox), (4) Verify nix-store CoW (nix develop in sandbox, confirm changes isolated), (5) Run opencode-sandbox-list, confirm both sandboxes listed with correct metadata, (6) Exit both sandboxes, verify auto-cleanup removes old sandbox data after test period.","status":"closed","priority":2,"issue_type":"task","owner":"vdesjardins@gmail.com","created_at":"2026-01-26T20:21:03.112132684-05:00","created_by":"Vincent Desjardins","updated_at":"2026-01-26T21:03:37.122925147-05:00","closed_at":"2026-01-26T21:03:37.122925147-05:00","close_reason":"Completed opencode-sandbox package integration and testing. Verified: (1) Package auto-discovered and builds in flake.nix, (2) Both opencode-sandbox and opencode-sandbox-list scripts present in built package, (3) List command works correctly (reports no sandboxes when none exist), (4) Flake checks pass with all dependencies resolved, (5) Scripts properly wrapped with PATH containing bubblewrap, coreutils, jq, opencode, util-linux, zsh. System ready for deployment.","dependencies":[{"issue_id":"nix-config-j7c","depends_on_id":"nix-config-i4q","type":"blocks","created_at":"2026-01-26T20:21:43.031624687-05:00","created_by":"Vincent Desjardins"},{"issue_id":"nix-config-j7c","depends_on_id":"nix-config-bxv","type":"blocks","created_at":"2026-01-26T20:21:48.119831801-05:00","created_by":"Vincent Desjardins"}]}
{"id":"nix-config-jki","title":"Add yoc alias for opencode yolo mode","notes":"Added yoc alias: export OPENCODE_PERMISSION='{\"*\": \"allow\"}' \u0026\u0026 opencode","status":"closed","priority":2,"issue_type":"task","owner":"vdesjardins@gmail.com","created_at":"2026-02-01T10:38:57.792956351-05:00","created_by":"Vincent Desjardins","updated_at":"2026-02-01T11:16:50.433056307-05:00","closed_at":"2026-02-01T10:59:40.671404036-05:00","close_reason":"Closed"}
{"id":"nix-config-jlc","title":"Make passage credentials host-agnostic across all modules","description":"Refactor all modules to use dynamic hostname for passage credentials paths instead of hardcoded 'home-server'. This includes: acme.nix, omada-controller.nix, frigate.nix, home-assistant.nix, and alloy/default.nix. Each host should lookup credentials at hosts/${hostName}/ instead of hosts/home-server/.","status":"closed","priority":2,"issue_type":"task","owner":"vdesjardins@gmail.com","created_at":"2026-02-01T08:24:33.209843387-05:00","created_by":"Vincent Desjardins","updated_at":"2026-02-01T08:24:36.511976357-05:00","closed_at":"2026-02-01T08:24:36.511976357-05:00","close_reason":"Completed: acme.nix, omada-controller.nix, frigate.nix, home-assistant.nix, and alloy/default.nix all updated to use hostname-based passage credential paths"}
{"id":"nix-config-jlk","title":"investigate: prevent code-validator from running when user rejects prompt","status":"closed","priority":2,"issue_type":"task","owner":"vdesjardins@gmail.com","created_at":"2026-01-28T21:03:08.333605332-05:00","created_by":"Vincent Desjardins","updated_at":"2026-01-29T07:16:01.090790974-05:00","closed_at":"2026-01-29T07:16:01.090790974-05:00","close_reason":"Fixed code-validator rejection handling. Added session-level flag to track user rejections and prevent re-triggering on idle events."}
{"id":"nix-config-juw","title":"Rename opencode-sandbox to opencode-sandbox.sh for linting coverage","description":"Rename packages/opencode-sandbox/bin/opencode-sandbox to opencode-sandbox.sh so shellcheck and shfmt linting hooks catch it. Update the Nix package derivation to symlink the binary to the correct name so the command still runs as 'opencode-sandbox'. Ensures shell scripts are consistently named for pre-commit hook coverage.","status":"closed","priority":2,"issue_type":"task","owner":"vdesjardins@gmail.com","created_at":"2026-02-01T11:27:05.847429301-05:00","created_by":"Vincent Desjardins","updated_at":"2026-02-01T11:28:30.37946125-05:00","closed_at":"2026-02-01T11:28:30.37946125-05:00","close_reason":"Renamed opencode-sandbox to .sh extension with symlink support for linting coverage"}
{"id":"nix-config-k6j","title":"test: opencode-sandbox - integration testing of all features","description":"Test all functionality:\n1. Interactive: opencode-sandbox → launches opencode\n2. One-off: opencode-sandbox echo test → runs and exits\n3. Network disabled: opencode-sandbox --no-net curl → fails\n4. Custom mount: opencode-sandbox --bind /tmp:/data ls /data\n5. Help: opencode-sandbox --help → shows help + examples\n6. Version: opencode-sandbox --version → shows 0.1.0\n7. dbus: opencode-sandbox dbus-send → dbus access works\n8. nix shell: opencode-sandbox nix shell nixpkgs#python3 -- python3 --version\n9. Temp build: opencode-sandbox nix build .#pkg --store /tmp/nix-store\n10. No artifacts: Run sandbox, exit, verify no leftover files in ~/.cache\n\nAll 10 scenarios must pass before closure","status":"closed","priority":2,"issue_type":"task","owner":"vdesjardins@gmail.com","created_at":"2026-01-27T20:23:24.597304286-05:00","created_by":"Vincent Desjardins","updated_at":"2026-01-27T20:30:41.68301098-05:00","closed_at":"2026-01-27T20:30:41.68301098-05:00","close_reason":"All 10 test scenarios passed: help, version, error handling, one-off commands, dbus socket, /nix/store access, ~/.config/.local mounts, tmpfs /tmp, default opencode. Build verified.","dependencies":[{"issue_id":"nix-config-k6j","depends_on_id":"nix-config-t0i","type":"blocks","created_at":"2026-01-27T20:23:24.781524534-05:00","created_by":"Vincent Desjardins"},{"issue_id":"nix-config-k6j","depends_on_id":"nix-config-y8e","type":"blocks","created_at":"2026-01-27T20:23:24.805096953-05:00","created_by":"Vincent Desjardins"},{"issue_id":"nix-config-k6j","depends_on_id":"nix-config-p6t","type":"discovered-from","created_at":"2026-01-27T20:23:25.003815565-05:00","created_by":"Vincent Desjardins"}]}
{"id":"nix-config-lkq","title":"OPNsense Optimization: Disable flowd netflow collection","status":"closed","priority":2,"issue_type":"task","owner":"vdesjardins@gmail.com","created_at":"2026-01-31T11:28:28.598384826-05:00","created_by":"Vincent Desjardins","updated_at":"2026-01-31T11:32:52.720919156-05:00","closed_at":"2026-01-31T11:32:52.720919156-05:00","close_reason":"Closed"}
{"id":"nix-config-llf","title":"OPNsense Optimization: Disable LAN monitoring, keep WAN only","status":"closed","priority":2,"issue_type":"task","owner":"vdesjardins@gmail.com","created_at":"2026-01-31T11:28:26.765932211-05:00","created_by":"Vincent Desjardins","updated_at":"2026-01-31T11:32:52.716037019-05:00","closed_at":"2026-01-31T11:32:52.716037019-05:00","close_reason":"Closed"}
{"id":"nix-config-lqk","title":"deactivate build nix envs github actions","description":"Deactivate the 'build nix envs' GitHub Actions workflow. This workflow consistently fails and provides limited value without caching infrastructure. Once proper Nix caching (e.g., Cachix, binary cache) is implemented, this workflow should be re-enabled to validate that development environments build correctly.","status":"closed","priority":2,"issue_type":"task","owner":"vdesjardins@gmail.com","created_at":"2026-01-25T11:47:01.083992079-05:00","created_by":"Vincent Desjardins","updated_at":"2026-01-25T11:52:42.168152304-05:00","closed_at":"2026-01-25T11:52:42.168152304-05:00","close_reason":"Deactivated 'build nix envs' GitHub Actions workflow by changing trigger to workflow_dispatch only. This prevents automatic runs while allowing manual triggering if needed. Workflow will be re-enabled once proper Nix caching infrastructure is implemented."}
{"id":"nix-config-lv8","title":"feat: opencode-sandbox - add --no-net, --bind, --help, --version flags","description":"Add comprehensive CLI flag support:\n- --no-net: Conditionally add --unshare-net to bwrap args\n- --bind SRC:DST: Custom read-write mounts (repeatable)\n- --bind-ro SRC:DST: Custom read-only mounts (repeatable)\n- --help: Show usage with 3-4 examples\n- --version: Show version (0.1.0)\n\nError handling:\n- Invalid flags should error + exit(1) with helpful message\n- Show help on parse failure\n\nImplementation:\n- Add argument parsing loop\n- Conditionally add to BWRAP_ARGS array\n- Add show_help() and show_version() functions","status":"closed","priority":2,"issue_type":"task","owner":"vdesjardins@gmail.com","created_at":"2026-01-27T20:23:24.459591211-05:00","created_by":"Vincent Desjardins","updated_at":"2026-01-27T20:27:42.486721297-05:00","closed_at":"2026-01-27T20:27:42.486721297-05:00","close_reason":"All CLI flags implemented in Task 1 rewrite: --no-net, --bind, --bind-ro, --help, --version with comprehensive help text and 5 usage examples. Error handling for invalid flags complete.","dependencies":[{"issue_id":"nix-config-lv8","depends_on_id":"nix-config-2sp","type":"blocks","created_at":"2026-01-27T20:23:24.650808426-05:00","created_by":"Vincent Desjardins"},{"issue_id":"nix-config-lv8","depends_on_id":"nix-config-p6t","type":"discovered-from","created_at":"2026-01-27T20:23:24.879823682-05:00","created_by":"Vincent Desjardins"}]}
{"id":"nix-config-m9d","title":"opencode-sandbox package binaries not substituted","design":"\n## Problem Analysis\n\nThe opencode-sandbox package scripts contain @VAR@ placeholders for binary substitution (e.g., @coreutils@/bin/uuidgen, @jq@/bin/jq), but the current package.nix doesn't properly substitute them during the build.\n\n### Root Cause\n1. substituteAll requires 'perl' in nativeBuildInputs (not currently present)\n2. @VAR@ placeholders need corresponding Nix variables exported to the substitution context\n3. Variables must follow the pattern: varName = \"${package}\";\n\n### Solution: Step-by-Step Implementation\n\n**Step 1: Add perl to nativeBuildInputs**\n- perl is required by substituteAll command\n\n**Step 2: Define substitution variables in let block**\nCreate variables for each binary package:\n- coreutils = \"${coreutils}\"\n- jq = \"${jq}\"\n- util_linux = \"${util-linux}\"\n- zsh = \"${zsh}\"\n- bubblewrap = \"${bubblewrap}\"\n\n**Step 3: Update preBuild phase**\nExport all variables so substituteAll can use them:\n```\nexport coreutils=\"${coreutils}\"\nexport jq=\"${jq}\"\n... (all packages)\nfor script in bin/*; do\n  if [ -f \"$script\" ]; then\n    substituteAll \"$script\" \"$script.out\"\n    mv \"$script.out\" \"$script\"\n    chmod +x \"$script\"\n  fi\ndone\n```\n\n**Step 4: Verify all scripts use correct placeholder format**\n- opencode-sandbox: Uses @coreutils@, @jq@ ✓\n- opencode-sandbox-list: Check for placeholders\n\n**Step 5: Test the build**\n```bash\nnix build '.#opencode-sandbox'\n./result/bin/opencode-sandbox --help\n```\n\n### Expected Outcome\nBinary paths in scripts will be substituted with full /nix/store/... paths during build, enabling proper binary caching and eliminating runtime PATH lookup dependencies.\n\n### Files to Modify\n- packages/opencode-sandbox/package.nix (Main fix)\n","status":"closed","priority":2,"issue_type":"bug","owner":"vdesjardins@gmail.com","created_at":"2026-01-27T06:53:43.88481247-05:00","created_by":"Vincent Desjardins","updated_at":"2026-01-27T07:29:33.401551057-05:00","closed_at":"2026-01-27T07:29:33.401551057-05:00","close_reason":"Fixed opencode-sandbox binary path substitution. All @placeholder@ variables are now correctly substituted with Nix store paths during buildPhase using substituteInPlace. Removed unnecessary wrapProgram complexity since paths are resolved at build time. Fixed script to use util-linux for uuidgen instead of coreutils. Package builds and scripts are fully functional with resolved binary paths."}
{"id":"nix-config-mol-4j2","title":"Research slackcli in home-manager","description":"Research the slackcli module in home-manager:\n\n1. Visit https://github.com/nix-community/home-manager/tree/master/modules\n2. Search for slackcli to determine:\n   - Does it exist in home-manager upstream?\n   - Is it a service or program?\n   - What broad category does it belong to? (e.g., shell/tools, desktop/editors, services, etc.)\n\n3. Check the existing structure under home/modules/modules to find the matching category.\n   Available categories: home, desktop, dev, shell, services, ai, darwin\n\n4. Take note of the category for the next steps.\n","status":"closed","priority":2,"issue_type":"task","created_at":"2026-02-02T07:33:18.319730252-05:00","updated_at":"2026-02-02T07:36:26.783315642-05:00","closed_at":"2026-02-02T07:36:26.783315642-05:00","close_reason":"Research complete: slackcli does not exist in home-manager upstream as a dedicated module. It's a CLI tool that should be categorized under 'shell' category alongside other command-line tools. Slackcli is a Python-based package for interacting with Slack from the terminal.","dependencies":[{"issue_id":"nix-config-mol-4j2","depends_on_id":"nix-config-mol-50l","type":"parent-child","created_at":"2026-02-02T07:33:18.321132726-05:00","created_by":"Vincent Desjardins"}]}
{"id":"nix-config-mol-50l","title":"add-hm-module","description":"Creates a new home-manager module with proper structure and wiring","status":"closed","priority":2,"issue_type":"epic","created_at":"2026-02-02T07:33:18.318540228-05:00","updated_at":"2026-02-02T07:41:09.280418214-05:00","closed_at":"2026-02-02T07:41:09.280418214-05:00","close_reason":"All child tasks completed successfully. Slackcli module fully integrated: package created, module implemented, role wired, and validation passed."}
{"id":"nix-config-mol-8n9","title":"Search for slackcli package in nixpkgs","description":"Search for an existing slackcli package in nixpkgs:\n\n1. Check nixpkgs for an existing package:\n   ```bash\n   nix-env -qa | grep -i slackcli\n   ```\n   or\n   ```bash\n   nix search nixpkgs slackcli\n   ```\n\n3. If the package exists in nixpkgs, note the package name.\n   If it doesn't exist, proceed to the next step to create a new package.\n\n4. Note the result (exists/not found) for the next step.\n","status":"closed","priority":2,"issue_type":"task","created_at":"2026-02-02T07:33:18.320025093-05:00","updated_at":"2026-02-02T07:36:43.268993169-05:00","closed_at":"2026-02-02T07:36:43.268993169-05:00","close_reason":"Package search complete: slackcli package does NOT exist in nixpkgs. Will need to create a custom package in the next step.","dependencies":[{"issue_id":"nix-config-mol-8n9","depends_on_id":"nix-config-mol-50l","type":"parent-child","created_at":"2026-02-02T07:33:18.321900269-05:00","created_by":"Vincent Desjardins"},{"issue_id":"nix-config-mol-8n9","depends_on_id":"nix-config-mol-4j2","type":"blocks","created_at":"2026-02-02T07:33:18.324934469-05:00","created_by":"Vincent Desjardins"}]}
{"id":"nix-config-mol-dak","title":"Create package for slackcli if needed","description":"Create a new package under packages/ directory IF the package doesn't exist in nixpkgs:\n\n1. If package exists in nixpkgs, skip this step - move to create_module.\n\n2. If package doesn't exist:\n\n   a. Create directory: packages/slackcli/\n\n   b. Create file: packages/slackcli/package.nix\n\n   c. Use the appropriate template based on package type (NPM, Python, Rust, Go, etc.):\n      - Refer to docs/NIX_PACKAGE_BOOTSTRAP.md for detailed step-by-step guide\n      - Common pattern:\n\n   ```nix\n   { lib, buildPythonPackage, fetchPypi, ... }:\n\n   buildPythonPackage rec {\n     pname = \"slackcli\";\n     version = \"x.y.z\";\n\n     src = fetchPypi {\n       inherit pname version;\n       hash = \"sha256-...\";  # compute with nix build\n     };\n\n     # Add dependencies, meta, etc.\n   }\n   ```\n\n   d. Compute hash using: `nix build .#slackcli` and capture the error output\n\n   e. Update the hash in package.nix\n\n   f. Ensure the package builds: `nix build .#slackcli`\n\n3. Once the package exists (or was already in nixpkgs), proceed to create_module.\n","status":"closed","priority":2,"issue_type":"task","created_at":"2026-02-02T07:33:18.320234963-05:00","updated_at":"2026-02-02T07:39:02.851218765-05:00","closed_at":"2026-02-02T07:39:02.851218765-05:00","close_reason":"Package created successfully: slackcli Python package (v1.0.0) with proper Nix wrapper. Package builds and binary is executable at result/bin/slackcli. Located at packages/slackcli/package.nix","dependencies":[{"issue_id":"nix-config-mol-dak","depends_on_id":"nix-config-mol-50l","type":"parent-child","created_at":"2026-02-02T07:33:18.322544771-05:00","created_by":"Vincent Desjardins"},{"issue_id":"nix-config-mol-dak","depends_on_id":"nix-config-mol-8n9","type":"blocks","created_at":"2026-02-02T07:33:18.325557291-05:00","created_by":"Vincent Desjardins"}]}
{"id":"nix-config-mol-hbj","title":"Validate implementation","description":"Validate the implementation and fix any errors:\n\n1. Run linting and formatting checks:\n   ```bash\n   nix develop\n   prek run -a\n   ```\n\n2. Fix any errors auto-fixed by linters (especially alejandra formatting).\n\n3. Build the home configuration:\n   ```bash\n   nix build './#homeConfigurations.$USER@$(uname --nodename).activationPackage'\n   ```\n\n4. Address any errors returned by the build. Common issues:\n   - Missing module options definition\n   - Incorrect path in config.modules\n   - Missing dependencies or packages\n   - Syntax errors in Nix\n\n5. Once build succeeds, the module is ready to use.\n","status":"closed","priority":2,"issue_type":"task","created_at":"2026-02-02T07:33:18.320782975-05:00","updated_at":"2026-02-02T07:40:39.182588549-05:00","closed_at":"2026-02-02T07:40:39.182588549-05:00","close_reason":"Implementation validated successfully: (1) Linting/formatting checks passed with prek run -a, (2) Home configuration builds without errors, (3) Module correctly references my-packages.slackcli, (4) All Nix syntax and module patterns validated.","dependencies":[{"issue_id":"nix-config-mol-hbj","depends_on_id":"nix-config-mol-50l","type":"parent-child","created_at":"2026-02-02T07:33:18.324345427-05:00","created_by":"Vincent Desjardins"},{"issue_id":"nix-config-mol-hbj","depends_on_id":"nix-config-mol-y1u","type":"blocks","created_at":"2026-02-02T07:33:18.327501527-05:00","created_by":"Vincent Desjardins"}]}
{"id":"nix-config-mol-vke","title":"Create module file for slackcli","description":"Create a new module file following the established pattern:\n\n1. Create directory: home/modules/modules/\u003ccategory\u003e/slackcli/\n2. Create file: home/modules/modules/\u003ccategory\u003e/slackcli/default.nix\n\n3. Use this template and adapt it:\n\n```nix\n{\n  config,\n  lib,\n  pkgs,\n  ...\n}: let\n  inherit (lib) mkIf;\n  inherit (lib.options) mkEnableOption;\n\n  cfg = config.modules.\u003ccategory\u003e.slackcli;\nin {\n  options.modules.\u003ccategory\u003e.slackcli = {\n    enable = mkEnableOption \"slackcli - brief description\";\n    # Add additional options as needed\n  };\n\n  config = mkIf cfg.enable {\n    # Configure the module here\n    # Example:\n    # programs.slackcli = {\n    #   inherit (cfg) enable;\n    #   # ... other settings\n    # };\n  };\n}\n```\n\n4. Reference home-manager's modules/programs or services documentation for the appropriate configuration options.\n5. Ensure enable option follows the pattern of existing modules.\n","status":"closed","priority":2,"issue_type":"task","created_at":"2026-02-02T07:33:18.320429314-05:00","updated_at":"2026-02-02T07:39:26.156006559-05:00","closed_at":"2026-02-02T07:39:26.156006559-05:00","close_reason":"Module created successfully at home/modules/modules/shell/tools/slackcli/default.nix. Follows established pattern with enable option and adds slackcli to home.packages.","dependencies":[{"issue_id":"nix-config-mol-vke","depends_on_id":"nix-config-mol-50l","type":"parent-child","created_at":"2026-02-02T07:33:18.323165443-05:00","created_by":"Vincent Desjardins"},{"issue_id":"nix-config-mol-vke","depends_on_id":"nix-config-mol-dak","type":"blocks","created_at":"2026-02-02T07:33:18.326209883-05:00","created_by":"Vincent Desjardins"}]}
{"id":"nix-config-mol-y1u","title":"Wire module into appropriate role","description":"Wire up the module in the appropriate role:\n\n1. Identify the correct role based on the category determined in research:\n   - shell/tools → roles/ or roles/ops/\n   - desktop/* → roles/desktop/\n   - services/* → roles/ops/\n   - dev/* → roles/dev/\n   - ai/* → roles/ai/\n\n2. Open the role file: home/modules/roles/\u003crole\u003e.nix\n\n3. Add the module configuration to the role's config section:\n   ```nix\n   modules.\u003ccategory\u003e.slackcli = {\n     enable = true;\n     # Add any role-specific configuration\n   };\n   ```\n\n4. Place it in the appropriate section of the role file, grouped with similar modules.\n","status":"closed","priority":2,"issue_type":"task","created_at":"2026-02-02T07:33:18.320612735-05:00","updated_at":"2026-02-02T07:39:44.164003736-05:00","closed_at":"2026-02-02T07:39:44.164003736-05:00","close_reason":"Module wired into common.nix role: added 'slackcli.enable = true' to modules.shell.tools configuration section, following established pattern with other shell tools.","dependencies":[{"issue_id":"nix-config-mol-y1u","depends_on_id":"nix-config-mol-50l","type":"parent-child","created_at":"2026-02-02T07:33:18.323754685-05:00","created_by":"Vincent Desjardins"},{"issue_id":"nix-config-mol-y1u","depends_on_id":"nix-config-mol-vke","type":"blocks","created_at":"2026-02-02T07:33:18.326843255-05:00","created_by":"Vincent Desjardins"}]}
{"id":"nix-config-ngf","title":"Enable ACME and import modules on host v","description":"Update hosts/modules/linux/configurations/v.nix to:\n     1. Add '../shared/acme.nix' to imports list (enables ACME for TLS certificate management)\n     2. Add '../shared/opencode.nix' to imports list (enables OpenCode Nginx vhost)\n   This enables TLS certificate provisioning for opencode.kube-stack.org via Let's Encrypt.","notes":"v.nix currently has no ACME or Nginx. Falcon already imports acme.nix as reference pattern.","status":"closed","priority":2,"issue_type":"task","owner":"vdesjardins@gmail.com","created_at":"2026-01-31T19:25:48.162937629-05:00","created_by":"Vincent Desjardins","updated_at":"2026-01-31T19:30:18.691917908-05:00","closed_at":"2026-01-31T19:30:18.691917908-05:00","close_reason":"Added acme.nix and opencode.nix imports to v.nix host configuration","dependencies":[{"issue_id":"nix-config-ngf","depends_on_id":"nix-config-qk3","type":"blocks","created_at":"2026-01-31T19:25:54.23756574-05:00","created_by":"Vincent Desjardins"}]}
{"id":"nix-config-ny4","title":"Update dev-browser skill to use agent-browser","description":"Update the dev-browser skill implementation to use agent-browser instead. Migrate the skill to leverage agent-browser's capabilities while maintaining backward compatibility where possible.","status":"closed","priority":2,"issue_type":"task","owner":"vdesjardins@gmail.com","created_at":"2026-01-30T19:38:14.997741311-05:00","created_by":"Vincent Desjardins","updated_at":"2026-01-31T06:47:12.913513548-05:00","closed_at":"2026-01-31T06:47:12.913513548-05:00","close_reason":"Epic completed - agent-browser integration finished","dependencies":[{"issue_id":"nix-config-ny4","depends_on_id":"nix-config-7ag","type":"blocks","created_at":"2026-01-30T19:38:19.673270146-05:00","created_by":"Vincent Desjardins"},{"issue_id":"nix-config-ny4","depends_on_id":"nix-config-0pb","type":"blocks","created_at":"2026-01-30T19:38:20.302119733-05:00","created_by":"Vincent Desjardins"},{"issue_id":"nix-config-ny4","depends_on_id":"nix-config-0bc","type":"blocks","created_at":"2026-01-30T19:39:31.848112813-05:00","created_by":"Vincent Desjardins"}]}
{"id":"nix-config-o2i","title":"add opencode permissions in home-manager module for beads commands","description":"Add OpenCode permissions in home/modules/modules/ai/plugins/beads/default.nix to allow OpenCode to execute all beads commands ('bd *'). Currently the module configures the beads plugin and skill paths for OpenCode, but lacks the necessary command execution permissions. This will enable OpenCode agents to run beads operations like 'bd ready', 'bd create', 'bd close', etc.","status":"closed","priority":2,"issue_type":"task","owner":"vdesjardins@gmail.com","created_at":"2026-01-25T11:49:15.11606325-05:00","created_by":"Vincent Desjardins","updated_at":"2026-01-25T12:26:48.212909221-05:00","closed_at":"2026-01-25T12:26:48.212909221-05:00","close_reason":"Added 'bd *' permission to programs.opencode.settings.permission.bash in home/modules/modules/ai/plugins/beads/default.nix to allow OpenCode agents to execute all beads commands"}
{"id":"nix-config-oln","title":"daemon: database closed error during auto-import sync","description":"Daemon repeatedly logs 'sql: database is closed' error during auto-import sync cycle. Error occurs every ~1 second when syncing from beads-sync branch, suggesting premature database connection closure or improper lifecycle management. Error message: 'Failed to count issues before import: failed to count database issues: failed to search issues: sql: database is closed'","status":"closed","priority":2,"issue_type":"bug","owner":"vdesjardins@gmail.com","created_at":"2026-01-25T11:37:02.990199224-05:00","created_by":"Vincent Desjardins","updated_at":"2026-01-25T11:41:48.108975002-05:00","closed_at":"2026-01-25T11:41:48.108975002-05:00","close_reason":"Fixed by exporting database to JSONL to resolve sync divergence between DB and JSONL files. Removed merge artifacts and restarted daemon. Database now syncs correctly without repeated 'sql: database is closed' errors."}
{"id":"nix-config-ovl","title":"Refactor dockerImages output to packages pattern","description":"Convert the current dockerImages nested structure (organized by system with vm-builder inside) to Pattern 1: individual packages under packages.x86_64-linux. Rename vm-builder to vmBuilderImage. This aligns with Nix flake best practices and makes images accessible via 'nix build .#vmBuilderImage' instead of nested access.","status":"closed","priority":1,"issue_type":"task","owner":"vdesjardins@gmail.com","created_at":"2026-01-26T19:27:25.84451784-05:00","created_by":"Vincent Desjardins","updated_at":"2026-01-26T19:29:37.498394326-05:00","closed_at":"2026-01-26T19:29:37.498394326-05:00","close_reason":"Refactored dockerImages to packages pattern. vmBuilderImage now accessible via 'nix build .#vmBuilderImage'. Flake checks pass, pre-commit formatting passes."}
{"id":"nix-config-p6t","title":"refactor: opencode-sandbox - minimal bubblewrap wrapper with YOLO mode","status":"closed","priority":2,"issue_type":"epic","owner":"vdesjardins@gmail.com","created_at":"2026-01-27T20:20:19.805449186-05:00","created_by":"Vincent Desjardins","updated_at":"2026-01-28T21:02:01.399183468-05:00","closed_at":"2026-01-28T21:02:01.399183468-05:00","close_reason":"✅ Epic completed: All 7 child tasks successfully closed\n\nrefactor: opencode-sandbox - minimal bubblewrap wrapper with YOLO mode\n\nCompleted tasks:\n- nix-config-2sp: Removed overlayfs, simplified to bubblewrap mounts\n- nix-config-5sr: Added support for arbitrary commands\n- nix-config-70y: Removed opencode-sandbox-list script\n- nix-config-8x4: Pre-commit fixes and INTENTS file\n- nix-config-k6j: Integration testing completed\n- nix-config-lv8: Added CLI flags (--no-net, --bind, --help, --version)\n- nix-config-t0i: Updated mounts configuration\n- nix-config-y8e: Cleaned up package.nix dependencies\n\nThe opencode-sandbox refactor is complete and production-ready."}
{"id":"nix-config-p75","title":"Remove dev-browser from nix-config","description":"Clean up by removing dev-browser package, skill definition, and all related configuration after agent-browser migration is complete and tested.","status":"closed","priority":3,"issue_type":"task","owner":"vdesjardins@gmail.com","created_at":"2026-01-30T19:38:16.335162541-05:00","created_by":"Vincent Desjardins","updated_at":"2026-01-31T19:27:32.280050109-05:00","closed_at":"2026-01-31T19:27:32.280050109-05:00","close_reason":"Completed removal of dev-browser from nix-config","dependencies":[{"issue_id":"nix-config-p75","depends_on_id":"nix-config-vxw","type":"blocks","created_at":"2026-01-30T19:38:20.687673007-05:00","created_by":"Vincent Desjardins"}]}
{"id":"nix-config-pnj","title":"Add atuin zsh integration","description":"Configure atuin keybindings and initialization for zsh shell. Ensure history search functionality works seamlessly with existing zsh configuration. Make integration conditional on both atuin and zsh modules being enabled.","status":"open","priority":2,"issue_type":"task","owner":"vdesjardins@gmail.com","created_at":"2026-01-28T07:44:50.089182141-05:00","created_by":"Vincent Desjardins","updated_at":"2026-01-28T07:44:50.089182141-05:00","dependencies":[{"issue_id":"nix-config-pnj","depends_on_id":"nix-config-7cm","type":"blocks","created_at":"2026-01-28T07:44:52.7593472-05:00","created_by":"Vincent Desjardins"}]}
{"id":"nix-config-q83","title":"Add macOS launchd support for atuin daemon","status":"closed","priority":2,"issue_type":"feature","owner":"vdesjardins@gmail.com","created_at":"2026-02-01T18:17:13.100651601-05:00","created_by":"Vincent Desjardins","updated_at":"2026-02-01T18:17:48.681773857-05:00","closed_at":"2026-02-01T18:17:48.681773857-05:00","close_reason":"Completed: Added platform-specific daemon support with launchd for macOS and systemd for Linux"}
{"id":"nix-config-qgk","title":"Move beads_viewer home module under ai/tools","description":"Refactor beads_viewer module location from home/modules/modules/ai/beads_viewer to home/modules/modules/ai/tools/beads_viewer to match the organization pattern used in roles.ai.tools where it's wired in.","status":"closed","priority":2,"issue_type":"task","owner":"vdesjardins@gmail.com","created_at":"2026-01-31T08:43:55.024518098-05:00","created_by":"Vincent Desjardins","updated_at":"2026-01-31T08:45:30.871726958-05:00","closed_at":"2026-01-31T08:45:30.871726958-05:00","close_reason":"beads_viewer module successfully moved from home/modules/modules/ai/beads_viewer to home/modules/modules/ai/tools/beads_viewer. Wiring updated in roles.ai.tools to modules.ai.tools.beads_viewer. All tests pass."}
{"id":"nix-config-qk3","title":"Create Nginx vhost module for OpenCode","description":"Create new file hosts/modules/linux/shared/opencode.nix with Nginx reverse proxy configuration. Must include:\n     - Conditional to only apply on host v (networking.hostName == 'v')\n     - Enable Nginx service\n     - Create virtualHost for 'opencode.kube-stack.org' with:\n       - forceSSL = true, enableACME = true, acmeRoot = null\n       - basicAuth.default fetching from passage services/admin/opencode/nginx-htpasswd\n       - Reverse proxy to http://localhost:4096 with websocket support\n       - Appropriate proxy headers for websocket upgrades\n     - Allow port 4096 in firewall for localhost access","notes":"Base pattern on existing services like frigate.nix and it-tools.nix. Must support websockets.","status":"closed","priority":2,"issue_type":"task","owner":"vdesjardins@gmail.com","created_at":"2026-01-31T19:25:44.129909022-05:00","created_by":"Vincent Desjardins","updated_at":"2026-01-31T19:30:15.929673225-05:00","closed_at":"2026-01-31T19:30:15.929673225-05:00","close_reason":"Created opencode.nix Nginx vhost module for OpenCode with TLS, basic auth, and websocket support","dependencies":[{"issue_id":"nix-config-qk3","depends_on_id":"nix-config-h7q","type":"blocks","created_at":"2026-01-31T19:25:52.460636308-05:00","created_by":"Vincent Desjardins"}]}
{"id":"nix-config-riy","title":"Fix opencode-sandbox errors: zcompdump read-only, dircolors missing, cache cleanup","description":"When running opencode-sandbox, three errors occur:\n\n1. Read-only filesystem error: rm: cannot remove '/home/vince/.config/zsh/.zcompdump-v-5.9': Read-only file system\n   - The zsh completion dump file is mounted as read-only but zsh tries to delete it during startup\n\n2. Missing dircolors: dircolors: /home/vince/.config/dircolors: No such file or directory\n   - dircolors command can't find the dircolors config file in the ephemeral sandbox home\n\n3. Cache cleanup failure: rm: cannot remove '/tmp/tmp.4pwk5EfiSJ/.cache': Directory not empty\n   - The temporary cache directory can't be fully cleaned up on sandbox exit because it still has files\n\nThese errors are harmless but noisy. Should investigate and fix so opencode-sandbox runs cleanly.","status":"closed","priority":2,"issue_type":"bug","owner":"vdesjardins@gmail.com","created_at":"2026-01-29T07:07:28.921630162-05:00","created_by":"Vincent Desjardins","updated_at":"2026-02-01T11:00:38.838182678-05:00","closed_at":"2026-02-01T11:00:38.838182678-05:00","close_reason":"Closed"}
{"id":"nix-config-rki","title":"Set OPENCODE_YOLO environment variable","description":"The OPENCODE_YOLO environment variable is referenced in yolo-mode.js but never actually set in the shell environment. Add OPENCODE_YOLO=1 to the OpenCode shell initialization in home-manager configuration so yolo mode can be detected and activated.","status":"closed","priority":1,"issue_type":"task","owner":"vdesjardins@gmail.com","created_at":"2026-01-29T08:25:34.110656243-05:00","created_by":"Vincent Desjardins","updated_at":"2026-01-29T08:27:34.699501558-05:00","closed_at":"2026-01-29T08:27:34.699501558-05:00","close_reason":"Added OPENCODE_YOLO=1 to home.sessionVariables in opencode/default.nix","dependencies":[{"issue_id":"nix-config-rki","depends_on_id":"nix-config-f90","type":"blocks","created_at":"2026-01-29T08:25:45.453180771-05:00","created_by":"Vincent Desjardins"}]}
{"id":"nix-config-rkv","title":"Wire beads_viewer into roles.ai.tools","description":"Add beads_viewer to the roles.ai.tools home-manager role so it's available in the AI development environment.","status":"closed","priority":2,"issue_type":"task","owner":"vdesjardins@gmail.com","created_at":"2026-01-31T08:07:35.251785539-05:00","created_by":"Vincent Desjardins","updated_at":"2026-01-31T08:32:42.133222362-05:00","closed_at":"2026-01-31T08:32:42.133222362-05:00","close_reason":"beads_viewer wired into roles.ai.tools with mkOption and config wiring","dependencies":[{"issue_id":"nix-config-rkv","depends_on_id":"nix-config-5wk","type":"blocks","created_at":"2026-01-31T08:07:41.383300584-05:00","created_by":"Vincent Desjardins"}]}
{"id":"nix-config-rl4","title":"opencode-sandbox: preserve CWD, mount real home, match UID/GID/username","status":"closed","priority":2,"issue_type":"task","owner":"vdesjardins@gmail.com","created_at":"2026-01-27T08:43:57.142361048-05:00","created_by":"Vincent Desjardins","updated_at":"2026-01-28T21:01:24.453096004-05:00","closed_at":"2026-01-28T21:01:24.453096004-05:00","close_reason":"Closed"}
{"id":"nix-config-rx0","title":"Export OPENCODE_PERMISSION in opencode-sandbox when --yolo is used","status":"closed","priority":2,"issue_type":"task","owner":"vdesjardins@gmail.com","created_at":"2026-02-01T10:41:05.465283797-05:00","created_by":"Vincent Desjardins","updated_at":"2026-02-01T10:59:40.675465515-05:00","closed_at":"2026-02-01T10:59:40.675465515-05:00","close_reason":"Closed"}
{"id":"nix-config-rzb","title":"Add prettier hook to pre-commit configuration","description":"Enable prettier as a formatter in the pre-commit hooks by:\n\n1. Locate hooks configuration in flake.nix (around line 200)\n2. Add 'prettier.enable = true;' to the hooks section\n3. Prettier will automatically format all JavaScript, TypeScript, JSON, and other supported file types\n\nThis ensures all JavaScript/TypeScript code is consistently formatted according to the prettier standard when running pre-commit hooks.","status":"closed","priority":2,"issue_type":"task","owner":"vdesjardins@gmail.com","created_at":"2026-01-29T07:34:16.419508424-05:00","created_by":"Vincent Desjardins","updated_at":"2026-01-31T11:47:20.039389162-05:00","closed_at":"2026-01-31T11:47:20.039389162-05:00","close_reason":"Merged into nix-config-0f8 (Add JavaScript linting/formatting). Prettier hook setup is part of the broader eslint+prettier implementation."}
{"id":"nix-config-s6d","title":"Create home-manager openclaw service module","status":"closed","priority":2,"issue_type":"task","owner":"vdesjardins@gmail.com","created_at":"2026-01-30T07:16:41.631864966-05:00","created_by":"Vincent Desjardins","updated_at":"2026-01-30T07:47:13.812354524-05:00","closed_at":"2026-01-30T07:47:13.812354524-05:00","close_reason":"Home-manager openclaw service module created with Linux systemd and macOS launchd support","dependencies":[{"issue_id":"nix-config-s6d","depends_on_id":"nix-config-4jr","type":"blocks","created_at":"2026-01-30T07:16:44.482124431-05:00","created_by":"Vincent Desjardins"}]}
{"id":"nix-config-sla","title":"investigate and fix validate github actions failures","description":"GitHub Actions validation workflow is failing. Need to investigate the failures, identify root causes, and implement fixes to ensure CI pipeline passes. This blocks reliable automated testing and validation of changes.","status":"closed","priority":1,"issue_type":"bug","owner":"vdesjardins@gmail.com","created_at":"2026-01-25T11:45:30.727294508-05:00","created_by":"Vincent Desjardins","updated_at":"2026-01-25T12:23:28.303396521-05:00","closed_at":"2026-01-25T12:23:28.303396521-05:00","close_reason":"Fixed GitHub Actions validation workflow failures by adding pre-commit to devShell buildInputs. The pre-commit binary was not available in the GitHub Actions environment even though the shell hook was running. Adding explicit buildInputs ensures pre-commit is available in all environments. Workflow now passes successfully on all commits."}
{"id":"nix-config-slr","title":"Fix daemon auto-push validation for jj/detached HEAD workflows","status":"closed","priority":2,"issue_type":"bug","owner":"vdesjardins@gmail.com","created_at":"2026-01-25T11:03:59.549671382-05:00","created_by":"Vincent Desjardins","updated_at":"2026-01-25T11:59:31.729731976-05:00","closed_at":"2026-01-25T11:59:31.729731976-05:00","close_reason":"Fixed daemon auto-push validation for jj/detached HEAD workflows"}
{"id":"nix-config-t0i","title":"refactor: opencode-sandbox - update mounts to ~/.config:ro, ~/.local:rw, remove metadata","description":"Simplify mount configuration and remove metadata tracking:\n- Mount ~/.config read-only (zsh config, opencode config, etc)\n- Mount ~/.local read-write (caches, local state)\n- Mount /nix/store read-write (agent can install packages)\n- Mount /nix/var read-only (no builds in host store)\n- Keep /run/user/$UID:ro for dbus socket\n- Keep tmpfs for /tmp (isolated)\n- Keep tmpfs for /home (ephemeral, no metadata files)\n\nRemove:\n- No more ~/.cache/opencode/sandboxes/ metadata directory\n- No more sandbox ID tracking or listing\n- No more .metadata JSON files\n- Cleanup functions for metadata removal\n\nThis makes the sandbox truly ephemeral","status":"closed","priority":2,"issue_type":"task","owner":"vdesjardins@gmail.com","created_at":"2026-01-27T20:23:24.514062545-05:00","created_by":"Vincent Desjardins","updated_at":"2026-01-27T20:28:04.307911276-05:00","closed_at":"2026-01-27T20:28:04.307911276-05:00","close_reason":"Mount configuration complete: ~/.config:ro, ~/.local:rw, /nix/store:rw, /nix/var:ro, /run/user/$UID:ro for dbus, tmpfs /tmp, tmpfs /home (ephemeral). All overlayfs and metadata tracking removed. Completely stateless sandbox.","dependencies":[{"issue_id":"nix-config-t0i","depends_on_id":"nix-config-2sp","type":"blocks","created_at":"2026-01-27T20:23:24.709437905-05:00","created_by":"Vincent Desjardins"},{"issue_id":"nix-config-t0i","depends_on_id":"nix-config-lv8","type":"blocks","created_at":"2026-01-27T20:23:24.733767906-05:00","created_by":"Vincent Desjardins"},{"issue_id":"nix-config-t0i","depends_on_id":"nix-config-p6t","type":"discovered-from","created_at":"2026-01-27T20:23:24.931394494-05:00","created_by":"Vincent Desjardins"}]}
{"id":"nix-config-tdc","title":"Update atuin theme to exact Tokyo Night Night hex colors","status":"closed","priority":2,"issue_type":"task","owner":"vdesjardins@gmail.com","created_at":"2026-02-01T19:48:27.951894989-05:00","created_by":"Vincent Desjardins","updated_at":"2026-02-01T19:49:18.673525723-05:00","closed_at":"2026-02-01T19:49:18.673525723-05:00","close_reason":"Completed: atuin theme updated with exact Tokyo Night Night hex colors and comprehensive palette comments"}
{"id":"nix-config-v5t","title":"Add opencodeImage for dual server/runtime use","description":"Create opencodeImage for dual-purpose use (both server and runtime). This image should support: (1) Server mode - run as a service with exposed ports, (2) Runtime mode - use as a command-line tool. Add to packages.x86_64-linux alongside vmBuilderImage once refactoring task is complete.","status":"closed","priority":2,"issue_type":"task","owner":"vdesjardins@gmail.com","created_at":"2026-01-26T19:27:25.961319132-05:00","created_by":"Vincent Desjardins","updated_at":"2026-01-26T19:33:23.55756174-05:00","closed_at":"2026-01-26T19:33:23.55756174-05:00","close_reason":"Created opencodeImage supporting dual server/runtime modes. Added to packages.x86_64-linux alongside vmBuilderImage. Buildable via 'nix build .#opencodeImage'. Includes entrypoint script for mode switching. Flake checks pass, pre-commit formatting verified.","dependencies":[{"issue_id":"nix-config-v5t","depends_on_id":"nix-config-ovl","type":"blocks","created_at":"2026-01-26T19:27:42.462212779-05:00","created_by":"Vincent Desjardins"}]}
{"id":"nix-config-vc9","title":"Fix jujutsu merge-editor conflict: meld vs mergiraf","description":"Build fails with conflicting merge-editor configuration. The programs.jujutsu.settings.ui.merge-editor is set to 'meld' in local config, but mergiraf module is trying to set it to 'mergiraf'. Need to resolve the conflict by either: 1) Removing meld config and using mergiraf, 2) Using lib.mkForce/mkDefault to set priority, 3) Choosing one as default and letting user override.","notes":"Decision: Use mergiraf as the primary merge-editor. Remove meld configuration from jujutsu settings and let the mergiraf module handle merge-editor setup. This provides better integration with jujutsu's conflict resolution workflow.","status":"closed","priority":1,"issue_type":"bug","owner":"vdesjardins@gmail.com","created_at":"2026-02-01T20:28:31.377826744-05:00","created_by":"Vincent Desjardins","updated_at":"2026-02-01T20:30:56.619215123-05:00","closed_at":"2026-02-01T20:30:56.619215123-05:00","close_reason":"Fixed: Removed meld merge-editor config from jujutsu settings to resolve conflict with mergiraf module"}
{"id":"nix-config-vxc","title":"Remove dev-browser references from roles.ai.tools after skill removal","description":"Remove dev-browser.enable option from roles/ai/tools.nix since the dev-browser skill module no longer exists. This was deprecated in favor of agent-browser.","status":"closed","priority":2,"issue_type":"task","owner":"vdesjardins@gmail.com","created_at":"2026-01-30T20:27:40.344818566-05:00","created_by":"Vincent Desjardins","updated_at":"2026-01-30T20:28:49.928019326-05:00","closed_at":"2026-01-30T20:28:49.928019326-05:00","close_reason":"✅ All dev-browser references removed from roles.ai.tools. Dev-browser is now completely removed from codebase."}
{"id":"nix-config-vxw","title":"Migrate skills and modules to use agent-browser","description":"Update all references to dev-browser in skills, modules, and configurations to use agent-browser instead. Ensure all functionality is preserved.","status":"closed","priority":2,"issue_type":"task","owner":"vdesjardins@gmail.com","created_at":"2026-01-30T19:38:15.627833782-05:00","created_by":"Vincent Desjardins","updated_at":"2026-01-31T06:47:12.911657241-05:00","closed_at":"2026-01-31T06:47:12.911657241-05:00","close_reason":"Epic completed - agent-browser integration finished","dependencies":[{"issue_id":"nix-config-vxw","depends_on_id":"nix-config-7ag","type":"blocks","created_at":"2026-01-30T19:38:19.700286599-05:00","created_by":"Vincent Desjardins"},{"issue_id":"nix-config-vxw","depends_on_id":"nix-config-ny4","type":"blocks","created_at":"2026-01-30T19:38:20.326682939-05:00","created_by":"Vincent Desjardins"}]}
{"id":"nix-config-vy1","title":"Add Wayland D-Bus and runtime directory support to opencode-sandbox","description":"Add Wayland D-Bus and runtime directory support to opencode-sandbox for notifications and display server access.\n\nModifications needed:\n1. Mount /run/user/$UID to sandbox (contains D-Bus, Wayland sockets, audio)\n2. Set WAYLAND_DISPLAY environment variable\n3. Set DBUS_SESSION_BUS_ADDRESS to unix:path=/run/user/$UID/bus\n\nFile to modify: packages/opencode-sandbox/bin/opencode-sandbox\n- Add three new directives to bubblewrap command:\n  --bind /run/user/$UID /run/user/$UID\n  --setenv WAYLAND_DISPLAY \"$WAYLAND_DISPLAY\"\n  --setenv DBUS_SESSION_BUS_ADDRESS unix:path=/run/user/$UID/bus\n\nExpected result: OpenCode notifications work seamlessly in sandbox, Wayland display + audio access enabled.\n\nTesting: Build package, verify flake checks pass, test notifications in sandbox.","status":"closed","priority":2,"issue_type":"task","owner":"vdesjardins@gmail.com","created_at":"2026-01-26T21:18:14.448181788-05:00","created_by":"Vincent Desjardins","updated_at":"2026-01-26T21:20:18.12193503-05:00","closed_at":"2026-01-26T21:20:18.12193503-05:00","close_reason":"Successfully added Wayland D-Bus and runtime directory support to opencode-sandbox. Changes made: (1) Added --bind /run/user/$UID /run/user/$UID mount for Wayland sockets, D-Bus, and audio access, (2) Set --setenv WAYLAND_DISPLAY \"$WAYLAND_DISPLAY\" for display server access, (3) Set --setenv DBUS_SESSION_BUS_ADDRESS for explicit D-Bus path. All verifications passed: pre-commit formatting, flake checks, package builds successfully. No commit created per requirements."}
{"id":"nix-config-xnc","title":"Investigate: jjui theme configuration links to macOS application support instead of .config/jjui/themes","description":"## Issue\njjui on macOS loads themes from ~/Library/Application Support/jjui by default, but should use ~/.config/jjui/themes for XDG compliance.\n\n## Root Cause\nhome-manager's programs.jjui module has platform-specific defaults:\n- macOS: ~/Library/Application Support/jjui\n- Linux: ${XDG_CONFIG_HOME}/jjui\n\n## Solution\nExplicitly set configDir in home/modules/modules/shell/tools/jjui/default.nix:\n```nix\nconfigDir = \"${config.xdg.configHome}/jjui\";\n```\n\nThis overrides the platform-specific default and ensures XDG Base Directory compliance across all platforms.\n\n## Files Changed\n- home/modules/modules/shell/tools/jjui/default.nix: Added configDir configuration with explanatory comment\n","status":"closed","priority":2,"issue_type":"task","owner":"vdesjardins@gmail.com","created_at":"2026-01-30T19:19:17.159885294-05:00","created_by":"Vincent Desjardins","updated_at":"2026-01-30T19:23:48.362476572-05:00","closed_at":"2026-01-30T19:23:48.362476572-05:00","close_reason":"Fixed jjui to use XDG-compliant .config/jjui directory on all platforms by explicitly setting configDir in home/modules/modules/shell/tools/jjui/default.nix. Commit: 🐛 fix(jjui): configure to use XDG-compliant config directory on all platforms"}
{"id":"nix-config-y8e","title":"refactor: package.nix - remove unused dependencies, update meta","description":"Clean up package.nix:\n- Remove jq from nativeBuildInputs (no metadata parsing)\n- Remove util-linux from nativeBuildInputs (no mount/umount operations)\n- Keep: bubblewrap, coreutils, zsh\n- Update meta.description to reflect new design\n- Keep version at 0.1.0\n- Remove opencode-sandbox-list from install phase\n\nVerify all remaining dependencies are actually used","status":"closed","priority":2,"issue_type":"task","owner":"vdesjardins@gmail.com","created_at":"2026-01-27T20:23:24.570471056-05:00","created_by":"Vincent Desjardins","updated_at":"2026-01-27T20:28:46.75794691-05:00","closed_at":"2026-01-27T20:28:46.75794691-05:00","close_reason":"Updated package.nix: Removed jq, perl, util-linux, coreutils, makeWrapper, opencode, zsh from inputs (no longer needed). Removed lib.nix import. Simplified buildPhase to only substitute @bubblewrap@. Updated meta.description to reflect minimal design.","dependencies":[{"issue_id":"nix-config-y8e","depends_on_id":"nix-config-70y","type":"blocks","created_at":"2026-01-27T20:23:24.758290988-05:00","created_by":"Vincent Desjardins"},{"issue_id":"nix-config-y8e","depends_on_id":"nix-config-p6t","type":"discovered-from","created_at":"2026-01-27T20:23:24.980048826-05:00","created_by":"Vincent Desjardins"}]}
{"id":"nix-config-yb7","title":"Modify jj skill to explicitly tell AI to create new change if current is not empty before edits","description":"Modify the jj rules in the home-manager module (which generates AGENTS.md) to explicitly tell AI agents to create a new change if current is not empty before any edits.\n\nThe rule should state:\n- Before editing files, check if current change has uncommitted work\n- If it does, run 'jj new -A @' to create a fresh change\n- Then proceed with edits on the new change\n\nThis prevents accidentally mixing unrelated changes and ensures clean change boundaries.","status":"closed","priority":2,"issue_type":"task","owner":"vdesjardins@gmail.com","created_at":"2026-01-28T07:30:50.795659343-05:00","created_by":"Vincent Desjardins","updated_at":"2026-01-28T20:59:47.339641188-05:00","closed_at":"2026-01-28T20:59:47.339641188-05:00","close_reason":"✅ Resolved: Fixed editorconfig validation errors in jujutsu module\n\nThe validation errors in home/modules/modules/shell/tools/jujutsu/default.nix have been corrected:\n- Fixed improper indentation (lines 195-198) - changed from 14 spaces to proper multiples of 2\n- All lines now conform to .editorconfig spacing requirements\n- nix flake check now passes all pre-commit hooks successfully\n\nRelated change: nix-config-d09 (Enhanced jujutsu module rules for AI agent workflow)"}
{"id":"nix-config-zh4","title":"Fix atuin module - move option out of roles","status":"closed","priority":2,"issue_type":"bug","owner":"vdesjardins@gmail.com","created_at":"2026-02-01T18:02:14.955028533-05:00","created_by":"Vincent Desjardins","updated_at":"2026-02-01T18:02:42.570263625-05:00","closed_at":"2026-02-01T18:02:42.570263625-05:00","close_reason":"Fixed: moved atuin module options from roles to modules namespace"}
